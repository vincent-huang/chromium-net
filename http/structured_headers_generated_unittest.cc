// Copyright 2020 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

#include "net/http/structured_headers.h"

#include <math.h>

#include <limits>
#include <string>

#include "testing/gtest/include/gtest/gtest.h"

// This file contains tests cases for the Structured Header parser and
// serializer, taken from the public test case repository at
// https://github.com/httpwg/structured-header-tests. All of the tests are
// named, so a given test case can be found in the JSON files in that repository
// by searching for the test name. This file is generated, with the test cases
// being automatically translated from the JSON source to C++ unit tests. Please
// do not modify, as the contents will be overwritten when this is re-generated.

// Generated on 2020-04-10 from structured-header-tests.git @
// 0a8ab1b649080239abb21ecd3ca15a4aead419aa

namespace net {
namespace structured_headers {
namespace {

// Helpers to make test cases clearer

Item Integer(int64_t value) {
  return Item(value);
}

std::pair<std::string, Item> BooleanParam(std::string key, bool value) {
  return std::make_pair(key, Item(value));
}

std::pair<std::string, Item> DoubleParam(std::string key, double value) {
  return std::make_pair(key, Item(value));
}

std::pair<std::string, Item> Param(std::string key, int64_t value) {
  return std::make_pair(key, Item(value));
}

std::pair<std::string, Item> Param(std::string key, std::string value) {
  return std::make_pair(key, Item(value));
}

std::pair<std::string, Item> TokenParam(std::string key, std::string value) {
  return std::make_pair(key, Item(value, Item::kTokenType));
}

// The following tests do not pass, and are are omitted from these lists:
// TODO(https://crbug.com/1069791): Cannot test headers with embedded NUL
// characters.
//  * "0x00 in dictionary key - serialise only",
//  * "0x00 in dictionary key",
//  * "0x00 in parameterised list key - serialise only",
//  * "0x00 in parameterised list key",
//  * "0x00 in string - serialise only",
//  * "0x00 in string",
//  * "0x00 in string",
//  * "0x00 in token - serialise only",
//  * "0x00 in token",
//  * "0x00 starting a parameterised list key",
//  * "0x00 starting a parameterised list key",
//  * "0x00 starting a token - serialise only",
//  * "0x00 starting an dictionary key - serialise only",
//  * "0x00 starting an dictionary key",
//  * "0x00 starting an token",

const struct ParameterizedItemTestCase {
  const char* name;
  const char* raw;
  const base::Optional<ParameterizedItem>
      expected;           // nullopt if parse error is expected.
  const char* canonical;  // nullptr if parse error is expected, or if canonical
                          // format is identical to raw.
} parameterized_item_test_cases[] = {
    {"basic binary",
     ":aGVsbG8=:",
     {{Item("hello", Item::kByteSequenceType), {}}}},
    {"empty binary", "::", {{Item("", Item::kByteSequenceType), {}}}},
    {"bad paddding",
     ":aGVsbG8:",
     {{Item("hello", Item::kByteSequenceType), {}}},
     ":aGVsbG8=:"},
    {"bad end delimiter", ":aGVsbG8=", base::nullopt},
    {"extra whitespace", ":aGVsb G8=:", base::nullopt},
    {"extra chars", ":aGVsbG!8=:", base::nullopt},
    {"suffix chars", ":aGVsbG8=!:", base::nullopt},
    {"non-zero pad bits",
     ":iZ==:",
     {{Item("\211", Item::kByteSequenceType), {}}},
     ":iQ==:"},
    {"non-ASCII binary",
     ":/+Ah:",
     {{Item("\377\340!", Item::kByteSequenceType), {}}}},
    {"base64url binary", ":_-Ah:", base::nullopt},
    {"basic true boolean", "?1", {{Item(true), {}}}},
    {"basic false boolean", "?0", {{Item(false), {}}}},
    {"unknown boolean", "?Q", base::nullopt},
    {"whitespace boolean", "? 1", base::nullopt},
    {"negative zero boolean", "?-0", base::nullopt},
    {"T boolean", "?T", base::nullopt},
    {"F boolean", "?F", base::nullopt},
    {"t boolean", "?t", base::nullopt},
    {"f boolean", "?f", base::nullopt},
    {"spelled-out True boolean", "?True", base::nullopt},
    {"spelled-out False boolean", "?False", base::nullopt},
    {"Foo-Example",
     "2; foourl=\"https://foo.example.com/\"",
     {{Integer(2), {Param("foourl", "https://foo.example.com/")}}},
     "2;foourl=\"https://foo.example.com/\""},
    {"Example-IntHeader",
     "1; a; b=?0",
     {{Integer(1), {BooleanParam("a", true), BooleanParam("b", false)}}},
     "1;a;b=?0"},
    {"Example-IntItemHeader", "5", {{Integer(5), {}}}},
    {"Example-IntItemHeader (params)",
     "5; foo=bar",
     {{Integer(5), {TokenParam("foo", "bar")}}},
     "5;foo=bar"},
    {"Example-IntegerHeader", "42", {{Integer(42), {}}}},
    {"Example-FloatHeader", "4.5", {{Item(4.500000), {}}}},
    {"Example-StringHeader", "\"hello world\"", {{Item("hello world"), {}}}},
    {"Example-BinaryHdr",
     ":cHJldGVuZCB0aGlzIGlzIGJpbmFyeSBjb250ZW50Lg==:",
     {{Item("pretend this is binary content.", Item::kByteSequenceType), {}}}},
    {"Example-BoolHdr", "?1", {{Item(true), {}}}},
    {"empty item", "", base::nullopt},
    {"leading space", "  1", {{Integer(1), {}}}, "1"},
    {"trailing space", "1  ", {{Integer(1), {}}}, "1"},
    {"leading and trailing space", "  1  ", {{Integer(1), {}}}, "1"},
    {"leading and trailing whitespace", "     1  ", {{Integer(1), {}}}, "1"},
    {"1 digits of zero", "0", {{Integer(0), {}}}, "0"},
    {"1 digit small integer", "1", {{Integer(1), {}}}},
    {"1 digit large integer", "9", {{Integer(9), {}}}},
    {"2 digits of zero", "00", {{Integer(0), {}}}, "0"},
    {"2 digit small integer", "11", {{Integer(11), {}}}},
    {"2 digit large integer", "99", {{Integer(99), {}}}},
    {"3 digits of zero", "000", {{Integer(0), {}}}, "0"},
    {"3 digit small integer", "111", {{Integer(111), {}}}},
    {"3 digit large integer", "999", {{Integer(999), {}}}},
    {"4 digits of zero", "0000", {{Integer(0), {}}}, "0"},
    {"4 digit small integer", "1111", {{Integer(1111), {}}}},
    {"4 digit large integer", "9999", {{Integer(9999), {}}}},
    {"5 digits of zero", "00000", {{Integer(0), {}}}, "0"},
    {"5 digit small integer", "11111", {{Integer(11111), {}}}},
    {"5 digit large integer", "99999", {{Integer(99999), {}}}},
    {"6 digits of zero", "000000", {{Integer(0), {}}}, "0"},
    {"6 digit small integer", "111111", {{Integer(111111), {}}}},
    {"6 digit large integer", "999999", {{Integer(999999), {}}}},
    {"7 digits of zero", "0000000", {{Integer(0), {}}}, "0"},
    {"7 digit small integer", "1111111", {{Integer(1111111), {}}}},
    {"7 digit large integer", "9999999", {{Integer(9999999), {}}}},
    {"8 digits of zero", "00000000", {{Integer(0), {}}}, "0"},
    {"8 digit small integer", "11111111", {{Integer(11111111), {}}}},
    {"8 digit large integer", "99999999", {{Integer(99999999), {}}}},
    {"9 digits of zero", "000000000", {{Integer(0), {}}}, "0"},
    {"9 digit small integer", "111111111", {{Integer(111111111), {}}}},
    {"9 digit large integer", "999999999", {{Integer(999999999), {}}}},
    {"10 digits of zero", "0000000000", {{Integer(0), {}}}, "0"},
    {"10 digit small integer", "1111111111", {{Integer(1111111111), {}}}},
    {"10 digit large integer", "9999999999", {{Integer(9999999999), {}}}},
    {"11 digits of zero", "00000000000", {{Integer(0), {}}}, "0"},
    {"11 digit small integer", "11111111111", {{Integer(11111111111), {}}}},
    {"11 digit large integer", "99999999999", {{Integer(99999999999), {}}}},
    {"12 digits of zero", "000000000000", {{Integer(0), {}}}, "0"},
    {"12 digit small integer", "111111111111", {{Integer(111111111111), {}}}},
    {"12 digit large integer", "999999999999", {{Integer(999999999999), {}}}},
    {"13 digits of zero", "0000000000000", {{Integer(0), {}}}, "0"},
    {"13 digit small integer", "1111111111111", {{Integer(1111111111111), {}}}},
    {"13 digit large integer", "9999999999999", {{Integer(9999999999999), {}}}},
    {"14 digits of zero", "00000000000000", {{Integer(0), {}}}, "0"},
    {"14 digit small integer",
     "11111111111111",
     {{Integer(11111111111111), {}}}},
    {"14 digit large integer",
     "99999999999999",
     {{Integer(99999999999999), {}}}},
    {"15 digits of zero", "000000000000000", {{Integer(0), {}}}, "0"},
    {"15 digit small integer",
     "111111111111111",
     {{Integer(111111111111111), {}}}},
    {"15 digit large integer",
     "999999999999999",
     {{Integer(999999999999999), {}}}},
    {"2 digit 0, 1 fractional small decimal",
     "0.1",
     {{Item(0.100000), {}}},
     "0.1"},
    {"2 digit, 1 fractional 0 decimal", "1.0", {{Item(1.000000), {}}}, "1.0"},
    {"2 digit, 1 fractional small decimal", "1.1", {{Item(1.100000), {}}}},
    {"2 digit, 1 fractional large decimal", "9.9", {{Item(9.900000), {}}}},
    {"3 digit 0, 2 fractional small decimal",
     "0.11",
     {{Item(0.110000), {}}},
     "0.11"},
    {"3 digit, 2 fractional 0 decimal", "1.00", {{Item(1.000000), {}}}, "1.0"},
    {"3 digit, 2 fractional small decimal", "1.11", {{Item(1.110000), {}}}},
    {"3 digit, 2 fractional large decimal", "9.99", {{Item(9.990000), {}}}},
    {"4 digit 0, 3 fractional small decimal",
     "0.111",
     {{Item(0.111000), {}}},
     "0.111"},
    {"4 digit, 3 fractional 0 decimal", "1.000", {{Item(1.000000), {}}}, "1.0"},
    {"4 digit, 3 fractional small decimal", "1.111", {{Item(1.111000), {}}}},
    {"4 digit, 3 fractional large decimal", "9.999", {{Item(9.999000), {}}}},
    {"3 digit 0, 1 fractional small decimal",
     "00.1",
     {{Item(0.100000), {}}},
     "0.1"},
    {"3 digit, 1 fractional 0 decimal",
     "11.0",
     {{Item(11.000000), {}}},
     "11.0"},
    {"3 digit, 1 fractional small decimal", "11.1", {{Item(11.100000), {}}}},
    {"3 digit, 1 fractional large decimal", "99.9", {{Item(99.900000), {}}}},
    {"4 digit 0, 2 fractional small decimal",
     "00.11",
     {{Item(0.110000), {}}},
     "0.11"},
    {"4 digit, 2 fractional 0 decimal",
     "11.00",
     {{Item(11.000000), {}}},
     "11.0"},
    {"4 digit, 2 fractional small decimal", "11.11", {{Item(11.110000), {}}}},
    {"4 digit, 2 fractional large decimal", "99.99", {{Item(99.990000), {}}}},
    {"5 digit 0, 3 fractional small decimal",
     "00.111",
     {{Item(0.111000), {}}},
     "0.111"},
    {"5 digit, 3 fractional 0 decimal",
     "11.000",
     {{Item(11.000000), {}}},
     "11.0"},
    {"5 digit, 3 fractional small decimal", "11.111", {{Item(11.111000), {}}}},
    {"5 digit, 3 fractional large decimal", "99.999", {{Item(99.999000), {}}}},
    {"4 digit 0, 1 fractional small decimal",
     "000.1",
     {{Item(0.100000), {}}},
     "0.1"},
    {"4 digit, 1 fractional 0 decimal",
     "111.0",
     {{Item(111.000000), {}}},
     "111.0"},
    {"4 digit, 1 fractional small decimal", "111.1", {{Item(111.100000), {}}}},
    {"4 digit, 1 fractional large decimal", "999.9", {{Item(999.900000), {}}}},
    {"5 digit 0, 2 fractional small decimal",
     "000.11",
     {{Item(0.110000), {}}},
     "0.11"},
    {"5 digit, 2 fractional 0 decimal",
     "111.00",
     {{Item(111.000000), {}}},
     "111.0"},
    {"5 digit, 2 fractional small decimal", "111.11", {{Item(111.110000), {}}}},
    {"5 digit, 2 fractional large decimal", "999.99", {{Item(999.990000), {}}}},
    {"6 digit 0, 3 fractional small decimal",
     "000.111",
     {{Item(0.111000), {}}},
     "0.111"},
    {"6 digit, 3 fractional 0 decimal",
     "111.000",
     {{Item(111.000000), {}}},
     "111.0"},
    {"6 digit, 3 fractional small decimal",
     "111.111",
     {{Item(111.111000), {}}}},
    {"6 digit, 3 fractional large decimal",
     "999.999",
     {{Item(999.999000), {}}}},
    {"5 digit 0, 1 fractional small decimal",
     "0000.1",
     {{Item(0.100000), {}}},
     "0.1"},
    {"5 digit, 1 fractional 0 decimal",
     "1111.0",
     {{Item(1111.000000), {}}},
     "1111.0"},
    {"5 digit, 1 fractional small decimal",
     "1111.1",
     {{Item(1111.100000), {}}}},
    {"5 digit, 1 fractional large decimal",
     "9999.9",
     {{Item(9999.900000), {}}}},
    {"6 digit 0, 2 fractional small decimal",
     "0000.11",
     {{Item(0.110000), {}}},
     "0.11"},
    {"6 digit, 2 fractional 0 decimal",
     "1111.00",
     {{Item(1111.000000), {}}},
     "1111.0"},
    {"6 digit, 2 fractional small decimal",
     "1111.11",
     {{Item(1111.110000), {}}}},
    {"6 digit, 2 fractional large decimal",
     "9999.99",
     {{Item(9999.990000), {}}}},
    {"7 digit 0, 3 fractional small decimal",
     "0000.111",
     {{Item(0.111000), {}}},
     "0.111"},
    {"7 digit, 3 fractional 0 decimal",
     "1111.000",
     {{Item(1111.000000), {}}},
     "1111.0"},
    {"7 digit, 3 fractional small decimal",
     "1111.111",
     {{Item(1111.111000), {}}}},
    {"7 digit, 3 fractional large decimal",
     "9999.999",
     {{Item(9999.999000), {}}}},
    {"6 digit 0, 1 fractional small decimal",
     "00000.1",
     {{Item(0.100000), {}}},
     "0.1"},
    {"6 digit, 1 fractional 0 decimal",
     "11111.0",
     {{Item(11111.000000), {}}},
     "11111.0"},
    {"6 digit, 1 fractional small decimal",
     "11111.1",
     {{Item(11111.100000), {}}}},
    {"6 digit, 1 fractional large decimal",
     "99999.9",
     {{Item(99999.900000), {}}}},
    {"7 digit 0, 2 fractional small decimal",
     "00000.11",
     {{Item(0.110000), {}}},
     "0.11"},
    {"7 digit, 2 fractional 0 decimal",
     "11111.00",
     {{Item(11111.000000), {}}},
     "11111.0"},
    {"7 digit, 2 fractional small decimal",
     "11111.11",
     {{Item(11111.110000), {}}}},
    {"7 digit, 2 fractional large decimal",
     "99999.99",
     {{Item(99999.990000), {}}}},
    {"8 digit 0, 3 fractional small decimal",
     "00000.111",
     {{Item(0.111000), {}}},
     "0.111"},
    {"8 digit, 3 fractional 0 decimal",
     "11111.000",
     {{Item(11111.000000), {}}},
     "11111.0"},
    {"8 digit, 3 fractional small decimal",
     "11111.111",
     {{Item(11111.111000), {}}}},
    {"8 digit, 3 fractional large decimal",
     "99999.999",
     {{Item(99999.999000), {}}}},
    {"7 digit 0, 1 fractional small decimal",
     "000000.1",
     {{Item(0.100000), {}}},
     "0.1"},
    {"7 digit, 1 fractional 0 decimal",
     "111111.0",
     {{Item(111111.000000), {}}},
     "111111.0"},
    {"7 digit, 1 fractional small decimal",
     "111111.1",
     {{Item(111111.100000), {}}}},
    {"7 digit, 1 fractional large decimal",
     "999999.9",
     {{Item(999999.900000), {}}}},
    {"8 digit 0, 2 fractional small decimal",
     "000000.11",
     {{Item(0.110000), {}}},
     "0.11"},
    {"8 digit, 2 fractional 0 decimal",
     "111111.00",
     {{Item(111111.000000), {}}},
     "111111.0"},
    {"8 digit, 2 fractional small decimal",
     "111111.11",
     {{Item(111111.110000), {}}}},
    {"8 digit, 2 fractional large decimal",
     "999999.99",
     {{Item(999999.990000), {}}}},
    {"9 digit 0, 3 fractional small decimal",
     "000000.111",
     {{Item(0.111000), {}}},
     "0.111"},
    {"9 digit, 3 fractional 0 decimal",
     "111111.000",
     {{Item(111111.000000), {}}},
     "111111.0"},
    {"9 digit, 3 fractional small decimal",
     "111111.111",
     {{Item(111111.111000), {}}}},
    {"9 digit, 3 fractional large decimal",
     "999999.999",
     {{Item(999999.999000), {}}}},
    {"8 digit 0, 1 fractional small decimal",
     "0000000.1",
     {{Item(0.100000), {}}},
     "0.1"},
    {"8 digit, 1 fractional 0 decimal",
     "1111111.0",
     {{Item(1111111.000000), {}}},
     "1111111.0"},
    {"8 digit, 1 fractional small decimal",
     "1111111.1",
     {{Item(1111111.100000), {}}}},
    {"8 digit, 1 fractional large decimal",
     "9999999.9",
     {{Item(9999999.900000), {}}}},
    {"9 digit 0, 2 fractional small decimal",
     "0000000.11",
     {{Item(0.110000), {}}},
     "0.11"},
    {"9 digit, 2 fractional 0 decimal",
     "1111111.00",
     {{Item(1111111.000000), {}}},
     "1111111.0"},
    {"9 digit, 2 fractional small decimal",
     "1111111.11",
     {{Item(1111111.110000), {}}}},
    {"9 digit, 2 fractional large decimal",
     "9999999.99",
     {{Item(9999999.990000), {}}}},
    {"10 digit 0, 3 fractional small decimal",
     "0000000.111",
     {{Item(0.111000), {}}},
     "0.111"},
    {"10 digit, 3 fractional 0 decimal",
     "1111111.000",
     {{Item(1111111.000000), {}}},
     "1111111.0"},
    {"10 digit, 3 fractional small decimal",
     "1111111.111",
     {{Item(1111111.111000), {}}}},
    {"10 digit, 3 fractional large decimal",
     "9999999.999",
     {{Item(9999999.999000), {}}}},
    {"9 digit 0, 1 fractional small decimal",
     "00000000.1",
     {{Item(0.100000), {}}},
     "0.1"},
    {"9 digit, 1 fractional 0 decimal",
     "11111111.0",
     {{Item(11111111.000000), {}}},
     "11111111.0"},
    {"9 digit, 1 fractional small decimal",
     "11111111.1",
     {{Item(11111111.100000), {}}}},
    {"9 digit, 1 fractional large decimal",
     "99999999.9",
     {{Item(99999999.900000), {}}}},
    {"10 digit 0, 2 fractional small decimal",
     "00000000.11",
     {{Item(0.110000), {}}},
     "0.11"},
    {"10 digit, 2 fractional 0 decimal",
     "11111111.00",
     {{Item(11111111.000000), {}}},
     "11111111.0"},
    {"10 digit, 2 fractional small decimal",
     "11111111.11",
     {{Item(11111111.110000), {}}}},
    {"10 digit, 2 fractional large decimal",
     "99999999.99",
     {{Item(99999999.990000), {}}}},
    {"11 digit 0, 3 fractional small decimal",
     "00000000.111",
     {{Item(0.111000), {}}},
     "0.111"},
    {"11 digit, 3 fractional 0 decimal",
     "11111111.000",
     {{Item(11111111.000000), {}}},
     "11111111.0"},
    {"11 digit, 3 fractional small decimal",
     "11111111.111",
     {{Item(11111111.111000), {}}}},
    {"11 digit, 3 fractional large decimal",
     "99999999.999",
     {{Item(99999999.999000), {}}}},
    {"10 digit 0, 1 fractional small decimal",
     "000000000.1",
     {{Item(0.100000), {}}},
     "0.1"},
    {"10 digit, 1 fractional 0 decimal",
     "111111111.0",
     {{Item(111111111.000000), {}}},
     "111111111.0"},
    {"10 digit, 1 fractional small decimal",
     "111111111.1",
     {{Item(111111111.100000), {}}}},
    {"10 digit, 1 fractional large decimal",
     "999999999.9",
     {{Item(999999999.900000), {}}}},
    {"11 digit 0, 2 fractional small decimal",
     "000000000.11",
     {{Item(0.110000), {}}},
     "0.11"},
    {"11 digit, 2 fractional 0 decimal",
     "111111111.00",
     {{Item(111111111.000000), {}}},
     "111111111.0"},
    {"11 digit, 2 fractional small decimal",
     "111111111.11",
     {{Item(111111111.110000), {}}}},
    {"11 digit, 2 fractional large decimal",
     "999999999.99",
     {{Item(999999999.990000), {}}}},
    {"12 digit 0, 3 fractional small decimal",
     "000000000.111",
     {{Item(0.111000), {}}},
     "0.111"},
    {"12 digit, 3 fractional 0 decimal",
     "111111111.000",
     {{Item(111111111.000000), {}}},
     "111111111.0"},
    {"12 digit, 3 fractional small decimal",
     "111111111.111",
     {{Item(111111111.111000), {}}}},
    {"12 digit, 3 fractional large decimal",
     "999999999.999",
     {{Item(999999999.999000), {}}}},
    {"11 digit 0, 1 fractional small decimal",
     "0000000000.1",
     {{Item(0.100000), {}}},
     "0.1"},
    {"11 digit, 1 fractional 0 decimal",
     "1111111111.0",
     {{Item(1111111111.000000), {}}},
     "1111111111.0"},
    {"11 digit, 1 fractional small decimal",
     "1111111111.1",
     {{Item(1111111111.100000), {}}}},
    {"11 digit, 1 fractional large decimal",
     "9999999999.9",
     {{Item(9999999999.900000), {}}}},
    {"12 digit 0, 2 fractional small decimal",
     "0000000000.11",
     {{Item(0.110000), {}}},
     "0.11"},
    {"12 digit, 2 fractional 0 decimal",
     "1111111111.00",
     {{Item(1111111111.000000), {}}},
     "1111111111.0"},
    {"12 digit, 2 fractional small decimal",
     "1111111111.11",
     {{Item(1111111111.110000), {}}}},
    {"12 digit, 2 fractional large decimal",
     "9999999999.99",
     {{Item(9999999999.990000), {}}}},
    {"13 digit 0, 3 fractional small decimal",
     "0000000000.111",
     {{Item(0.111000), {}}},
     "0.111"},
    {"13 digit, 3 fractional 0 decimal",
     "1111111111.000",
     {{Item(1111111111.000000), {}}},
     "1111111111.0"},
    {"13 digit, 3 fractional small decimal",
     "1111111111.111",
     {{Item(1111111111.111000), {}}}},
    {"13 digit, 3 fractional large decimal",
     "9999999999.999",
     {{Item(9999999999.999001), {}}}},
    {"12 digit 0, 1 fractional small decimal",
     "00000000000.1",
     {{Item(0.100000), {}}},
     "0.1"},
    {"12 digit, 1 fractional 0 decimal",
     "11111111111.0",
     {{Item(11111111111.000000), {}}},
     "11111111111.0"},
    {"12 digit, 1 fractional small decimal",
     "11111111111.1",
     {{Item(11111111111.100000), {}}}},
    {"12 digit, 1 fractional large decimal",
     "99999999999.9",
     {{Item(99999999999.899994), {}}}},
    {"13 digit 0, 2 fractional small decimal",
     "00000000000.11",
     {{Item(0.110000), {}}},
     "0.11"},
    {"13 digit, 2 fractional 0 decimal",
     "11111111111.00",
     {{Item(11111111111.000000), {}}},
     "11111111111.0"},
    {"13 digit, 2 fractional small decimal",
     "11111111111.11",
     {{Item(11111111111.110001), {}}}},
    {"13 digit, 2 fractional large decimal",
     "99999999999.99",
     {{Item(99999999999.990005), {}}}},
    {"14 digit 0, 3 fractional small decimal",
     "00000000000.111",
     {{Item(0.111000), {}}},
     "0.111"},
    {"14 digit, 3 fractional 0 decimal",
     "11111111111.000",
     {{Item(11111111111.000000), {}}},
     "11111111111.0"},
    {"14 digit, 3 fractional small decimal",
     "11111111111.111",
     {{Item(11111111111.111000), {}}}},
    {"14 digit, 3 fractional large decimal",
     "99999999999.999",
     {{Item(99999999999.998993), {}}}},
    {"13 digit 0, 1 fractional small decimal",
     "000000000000.1",
     {{Item(0.100000), {}}},
     "0.1"},
    {"13 digit, 1 fractional 0 decimal",
     "111111111111.0",
     {{Item(111111111111.000000), {}}},
     "111111111111.0"},
    {"13 digit, 1 fractional small decimal",
     "111111111111.1",
     {{Item(111111111111.100006), {}}}},
    {"13 digit, 1 fractional large decimal",
     "999999999999.9",
     {{Item(999999999999.900024), {}}}},
    {"14 digit 0, 2 fractional small decimal",
     "000000000000.11",
     {{Item(0.110000), {}}},
     "0.11"},
    {"14 digit, 2 fractional 0 decimal",
     "111111111111.00",
     {{Item(111111111111.000000), {}}},
     "111111111111.0"},
    {"14 digit, 2 fractional small decimal",
     "111111111111.11",
     {{Item(111111111111.110001), {}}}},
    {"14 digit, 2 fractional large decimal",
     "999999999999.99",
     {{Item(999999999999.989990), {}}}},
    {"15 digit 0, 3 fractional small decimal",
     "000000000000.111",
     {{Item(0.111000), {}}},
     "0.111"},
    {"15 digit, 3 fractional 0 decimal",
     "111111111111.000",
     {{Item(111111111111.000000), {}}},
     "111111111111.0"},
    {"15 digit, 3 fractional small decimal",
     "111111111111.111",
     {{Item(111111111111.110992), {}}}},
    {"15 digit, 3 fractional large decimal",
     "999999999999.999",
     {{Item(999999999999.999023), {}}}},
    {"too many digit 0 decimal", "000000000000000.0", base::nullopt},
    {"too many fractional digits 0 decimal", "000000000000.0000",
     base::nullopt},
    {"too many digit 9 decimal", "999999999999999.9", base::nullopt},
    {"too many fractional digits 9 decimal", "999999999999.9999",
     base::nullopt},
    {"basic integer", "42", {{Integer(42), {}}}},
    {"zero integer", "0", {{Integer(0), {}}}},
    {"leading 0 zero", "00", {{Integer(0), {}}}, "0"},
    {"negative zero", "-0", {{Integer(0), {}}}, "0"},
    {"double negative zero", "--0", base::nullopt},
    {"negative integer", "-42", {{Integer(-42), {}}}},
    {"leading 0 integer", "042", {{Integer(42), {}}}, "42"},
    {"leading 0 negative integer", "-042", {{Integer(-42), {}}}, "-42"},
    {"leading 0 zero", "00", {{Integer(0), {}}}, "0"},
    {"comma", "2,3", base::nullopt},
    {"negative non-DIGIT first character", "-a23", base::nullopt},
    {"sign out of place", "4-2", base::nullopt},
    {"whitespace after sign", "- 42", base::nullopt},
    {"long integer", "123456789012345", {{Integer(123456789012345), {}}}},
    {"long negative integer",
     "-123456789012345",
     {{Integer(-123456789012345), {}}}},
    {"too long integer", "1234567890123456", base::nullopt},
    {"negative too long integer", "-1234567890123456", base::nullopt},
    {"simple decimal", "1.23", {{Item(1.230000), {}}}},
    {"negative decimal", "-1.23", {{Item(-1.230000), {}}}},
    {"decimal, whitespace after decimal", "1. 23", base::nullopt},
    {"decimal, whitespace before decimal", "1 .23", base::nullopt},
    {"negative decimal, whitespace after sign", "- 1.23", base::nullopt},
    {"tricky precision decimal",
     "123456789012.1",
     {{Item(123456789012.100006), {}}}},
    {"double decimal decimal", "1.5.4", base::nullopt},
    {"adjacent double decimal decimal", "1..4", base::nullopt},
    {"decimal with three fractional digits", "1.123", {{Item(1.123000), {}}}},
    {"negative decimal with three fractional digits",
     "-1.123",
     {{Item(-1.123000), {}}}},
    {"decimal with four fractional digits", "1.1234", base::nullopt},
    {"negative decimal with four fractional digits", "-1.1234", base::nullopt},
    {"decimal with thirteen integer digits", "1234567890123.0", base::nullopt},
    {"negative decimal with thirteen integer digits", "-1234567890123.0",
     base::nullopt},
    {"0x01 in string", "\" \001 \"", base::nullopt},
    {"0x02 in string", "\" \002 \"", base::nullopt},
    {"0x03 in string", "\" \003 \"", base::nullopt},
    {"0x04 in string", "\" \004 \"", base::nullopt},
    {"0x05 in string", "\" \005 \"", base::nullopt},
    {"0x06 in string", "\" \006 \"", base::nullopt},
    {"0x07 in string", "\" \a \"", base::nullopt},
    {"0x08 in string", "\" \b \"", base::nullopt},
    {"0x09 in string", "\" \t \"", base::nullopt},
    {"0x0a in string", "\" \n \"", base::nullopt},
    {"0x0b in string", "\" \v \"", base::nullopt},
    {"0x0c in string", "\" \f \"", base::nullopt},
    {"0x0d in string", "\" \r \"", base::nullopt},
    {"0x0e in string", "\" \016 \"", base::nullopt},
    {"0x0f in string", "\" \017 \"", base::nullopt},
    {"0x10 in string", "\" \020 \"", base::nullopt},
    {"0x11 in string", "\" \021 \"", base::nullopt},
    {"0x12 in string", "\" \022 \"", base::nullopt},
    {"0x13 in string", "\" \023 \"", base::nullopt},
    {"0x14 in string", "\" \024 \"", base::nullopt},
    {"0x15 in string", "\" \025 \"", base::nullopt},
    {"0x16 in string", "\" \026 \"", base::nullopt},
    {"0x17 in string", "\" \027 \"", base::nullopt},
    {"0x18 in string", "\" \030 \"", base::nullopt},
    {"0x19 in string", "\" \031 \"", base::nullopt},
    {"0x1a in string", "\" \032 \"", base::nullopt},
    {"0x1b in string", "\" \033 \"", base::nullopt},
    {"0x1c in string", "\" \034 \"", base::nullopt},
    {"0x1d in string", "\" \035 \"", base::nullopt},
    {"0x1e in string", "\" \036 \"", base::nullopt},
    {"0x1f in string", "\" \037 \"", base::nullopt},
    {"0x20 in string", "\"   \"", {{Item("   "), {}}}},
    {"0x21 in string", "\" ! \"", {{Item(" ! "), {}}}},
    {"0x22 in string", "\" \" \"", base::nullopt},
    {"0x23 in string", "\" # \"", {{Item(" # "), {}}}},
    {"0x24 in string", "\" $ \"", {{Item(" $ "), {}}}},
    {"0x25 in string", "\" % \"", {{Item(" % "), {}}}},
    {"0x26 in string", "\" & \"", {{Item(" & "), {}}}},
    {"0x27 in string", "\" ' \"", {{Item(" ' "), {}}}},
    {"0x28 in string", "\" ( \"", {{Item(" ( "), {}}}},
    {"0x29 in string", "\" ) \"", {{Item(" ) "), {}}}},
    {"0x2a in string", "\" * \"", {{Item(" * "), {}}}},
    {"0x2b in string", "\" + \"", {{Item(" + "), {}}}},
    {"0x2c in string", "\" , \"", {{Item(" , "), {}}}},
    {"0x2d in string", "\" - \"", {{Item(" - "), {}}}},
    {"0x2e in string", "\" . \"", {{Item(" . "), {}}}},
    {"0x2f in string", "\" / \"", {{Item(" / "), {}}}},
    {"0x30 in string", "\" 0 \"", {{Item(" 0 "), {}}}},
    {"0x31 in string", "\" 1 \"", {{Item(" 1 "), {}}}},
    {"0x32 in string", "\" 2 \"", {{Item(" 2 "), {}}}},
    {"0x33 in string", "\" 3 \"", {{Item(" 3 "), {}}}},
    {"0x34 in string", "\" 4 \"", {{Item(" 4 "), {}}}},
    {"0x35 in string", "\" 5 \"", {{Item(" 5 "), {}}}},
    {"0x36 in string", "\" 6 \"", {{Item(" 6 "), {}}}},
    {"0x37 in string", "\" 7 \"", {{Item(" 7 "), {}}}},
    {"0x38 in string", "\" 8 \"", {{Item(" 8 "), {}}}},
    {"0x39 in string", "\" 9 \"", {{Item(" 9 "), {}}}},
    {"0x3a in string", "\" : \"", {{Item(" : "), {}}}},
    {"0x3b in string", "\" ; \"", {{Item(" ; "), {}}}},
    {"0x3c in string", "\" < \"", {{Item(" < "), {}}}},
    {"0x3d in string", "\" = \"", {{Item(" = "), {}}}},
    {"0x3e in string", "\" > \"", {{Item(" > "), {}}}},
    {"0x3f in string", "\" ? \"", {{Item(" ? "), {}}}},
    {"0x40 in string", "\" @ \"", {{Item(" @ "), {}}}},
    {"0x41 in string", "\" A \"", {{Item(" A "), {}}}},
    {"0x42 in string", "\" B \"", {{Item(" B "), {}}}},
    {"0x43 in string", "\" C \"", {{Item(" C "), {}}}},
    {"0x44 in string", "\" D \"", {{Item(" D "), {}}}},
    {"0x45 in string", "\" E \"", {{Item(" E "), {}}}},
    {"0x46 in string", "\" F \"", {{Item(" F "), {}}}},
    {"0x47 in string", "\" G \"", {{Item(" G "), {}}}},
    {"0x48 in string", "\" H \"", {{Item(" H "), {}}}},
    {"0x49 in string", "\" I \"", {{Item(" I "), {}}}},
    {"0x4a in string", "\" J \"", {{Item(" J "), {}}}},
    {"0x4b in string", "\" K \"", {{Item(" K "), {}}}},
    {"0x4c in string", "\" L \"", {{Item(" L "), {}}}},
    {"0x4d in string", "\" M \"", {{Item(" M "), {}}}},
    {"0x4e in string", "\" N \"", {{Item(" N "), {}}}},
    {"0x4f in string", "\" O \"", {{Item(" O "), {}}}},
    {"0x50 in string", "\" P \"", {{Item(" P "), {}}}},
    {"0x51 in string", "\" Q \"", {{Item(" Q "), {}}}},
    {"0x52 in string", "\" R \"", {{Item(" R "), {}}}},
    {"0x53 in string", "\" S \"", {{Item(" S "), {}}}},
    {"0x54 in string", "\" T \"", {{Item(" T "), {}}}},
    {"0x55 in string", "\" U \"", {{Item(" U "), {}}}},
    {"0x56 in string", "\" V \"", {{Item(" V "), {}}}},
    {"0x57 in string", "\" W \"", {{Item(" W "), {}}}},
    {"0x58 in string", "\" X \"", {{Item(" X "), {}}}},
    {"0x59 in string", "\" Y \"", {{Item(" Y "), {}}}},
    {"0x5a in string", "\" Z \"", {{Item(" Z "), {}}}},
    {"0x5b in string", "\" [ \"", {{Item(" [ "), {}}}},
    {"0x5c in string", "\" \\ \"", base::nullopt},
    {"0x5d in string", "\" ] \"", {{Item(" ] "), {}}}},
    {"0x5e in string", "\" ^ \"", {{Item(" ^ "), {}}}},
    {"0x5f in string", "\" _ \"", {{Item(" _ "), {}}}},
    {"0x60 in string", "\" ` \"", {{Item(" ` "), {}}}},
    {"0x61 in string", "\" a \"", {{Item(" a "), {}}}},
    {"0x62 in string", "\" b \"", {{Item(" b "), {}}}},
    {"0x63 in string", "\" c \"", {{Item(" c "), {}}}},
    {"0x64 in string", "\" d \"", {{Item(" d "), {}}}},
    {"0x65 in string", "\" e \"", {{Item(" e "), {}}}},
    {"0x66 in string", "\" f \"", {{Item(" f "), {}}}},
    {"0x67 in string", "\" g \"", {{Item(" g "), {}}}},
    {"0x68 in string", "\" h \"", {{Item(" h "), {}}}},
    {"0x69 in string", "\" i \"", {{Item(" i "), {}}}},
    {"0x6a in string", "\" j \"", {{Item(" j "), {}}}},
    {"0x6b in string", "\" k \"", {{Item(" k "), {}}}},
    {"0x6c in string", "\" l \"", {{Item(" l "), {}}}},
    {"0x6d in string", "\" m \"", {{Item(" m "), {}}}},
    {"0x6e in string", "\" n \"", {{Item(" n "), {}}}},
    {"0x6f in string", "\" o \"", {{Item(" o "), {}}}},
    {"0x70 in string", "\" p \"", {{Item(" p "), {}}}},
    {"0x71 in string", "\" q \"", {{Item(" q "), {}}}},
    {"0x72 in string", "\" r \"", {{Item(" r "), {}}}},
    {"0x73 in string", "\" s \"", {{Item(" s "), {}}}},
    {"0x74 in string", "\" t \"", {{Item(" t "), {}}}},
    {"0x75 in string", "\" u \"", {{Item(" u "), {}}}},
    {"0x76 in string", "\" v \"", {{Item(" v "), {}}}},
    {"0x77 in string", "\" w \"", {{Item(" w "), {}}}},
    {"0x78 in string", "\" x \"", {{Item(" x "), {}}}},
    {"0x79 in string", "\" y \"", {{Item(" y "), {}}}},
    {"0x7a in string", "\" z \"", {{Item(" z "), {}}}},
    {"0x7b in string", "\" { \"", {{Item(" { "), {}}}},
    {"0x7c in string", "\" | \"", {{Item(" | "), {}}}},
    {"0x7d in string", "\" } \"", {{Item(" } "), {}}}},
    {"0x7e in string", "\" ~ \"", {{Item(" ~ "), {}}}},
    {"0x7f in string", "\" \177 \"", base::nullopt},
    {"0x01 in string", "\"\\\001\"", base::nullopt},
    {"0x02 in string", "\"\\\002\"", base::nullopt},
    {"0x03 in string", "\"\\\003\"", base::nullopt},
    {"0x04 in string", "\"\\\004\"", base::nullopt},
    {"0x05 in string", "\"\\\005\"", base::nullopt},
    {"0x06 in string", "\"\\\006\"", base::nullopt},
    {"0x07 in string", "\"\\\a\"", base::nullopt},
    {"0x08 in string", "\"\\\b\"", base::nullopt},
    {"0x09 in string", "\"\\\t\"", base::nullopt},
    {"0x0a in string", "\"\\\n\"", base::nullopt},
    {"0x0b in string", "\"\\\v\"", base::nullopt},
    {"0x0c in string", "\"\\\f\"", base::nullopt},
    {"0x0d in string", "\"\\\r\"", base::nullopt},
    {"0x0e in string", "\"\\\016\"", base::nullopt},
    {"0x0f in string", "\"\\\017\"", base::nullopt},
    {"0x10 in string", "\"\\\020\"", base::nullopt},
    {"0x11 in string", "\"\\\021\"", base::nullopt},
    {"0x12 in string", "\"\\\022\"", base::nullopt},
    {"0x13 in string", "\"\\\023\"", base::nullopt},
    {"0x14 in string", "\"\\\024\"", base::nullopt},
    {"0x15 in string", "\"\\\025\"", base::nullopt},
    {"0x16 in string", "\"\\\026\"", base::nullopt},
    {"0x17 in string", "\"\\\027\"", base::nullopt},
    {"0x18 in string", "\"\\\030\"", base::nullopt},
    {"0x19 in string", "\"\\\031\"", base::nullopt},
    {"0x1a in string", "\"\\\032\"", base::nullopt},
    {"0x1b in string", "\"\\\033\"", base::nullopt},
    {"0x1c in string", "\"\\\034\"", base::nullopt},
    {"0x1d in string", "\"\\\035\"", base::nullopt},
    {"0x1e in string", "\"\\\036\"", base::nullopt},
    {"0x1f in string", "\"\\\037\"", base::nullopt},
    {"0x20 in string", "\"\\ \"", base::nullopt},
    {"0x21 in string", "\"\\!\"", base::nullopt},
    {"0x22 in string", "\"\\\"\"", {{Item("\""), {}}}},
    {"0x23 in string", "\"\\#\"", base::nullopt},
    {"0x24 in string", "\"\\$\"", base::nullopt},
    {"0x25 in string", "\"\\%\"", base::nullopt},
    {"0x26 in string", "\"\\&\"", base::nullopt},
    {"0x27 in string", "\"\\'\"", base::nullopt},
    {"0x28 in string", "\"\\(\"", base::nullopt},
    {"0x29 in string", "\"\\)\"", base::nullopt},
    {"0x2a in string", "\"\\*\"", base::nullopt},
    {"0x2b in string", "\"\\+\"", base::nullopt},
    {"0x2c in string", "\"\\,\"", base::nullopt},
    {"0x2d in string", "\"\\-\"", base::nullopt},
    {"0x2e in string", "\"\\.\"", base::nullopt},
    {"0x2f in string", "\"\\/\"", base::nullopt},
    {"0x30 in string", "\"\\0\"", base::nullopt},
    {"0x31 in string", "\"\\1\"", base::nullopt},
    {"0x32 in string", "\"\\2\"", base::nullopt},
    {"0x33 in string", "\"\\3\"", base::nullopt},
    {"0x34 in string", "\"\\4\"", base::nullopt},
    {"0x35 in string", "\"\\5\"", base::nullopt},
    {"0x36 in string", "\"\\6\"", base::nullopt},
    {"0x37 in string", "\"\\7\"", base::nullopt},
    {"0x38 in string", "\"\\8\"", base::nullopt},
    {"0x39 in string", "\"\\9\"", base::nullopt},
    {"0x3a in string", "\"\\:\"", base::nullopt},
    {"0x3b in string", "\"\\;\"", base::nullopt},
    {"0x3c in string", "\"\\<\"", base::nullopt},
    {"0x3d in string", "\"\\=\"", base::nullopt},
    {"0x3e in string", "\"\\>\"", base::nullopt},
    {"0x3f in string", "\"\\?\"", base::nullopt},
    {"0x40 in string", "\"\\@\"", base::nullopt},
    {"0x41 in string", "\"\\A\"", base::nullopt},
    {"0x42 in string", "\"\\B\"", base::nullopt},
    {"0x43 in string", "\"\\C\"", base::nullopt},
    {"0x44 in string", "\"\\D\"", base::nullopt},
    {"0x45 in string", "\"\\E\"", base::nullopt},
    {"0x46 in string", "\"\\F\"", base::nullopt},
    {"0x47 in string", "\"\\G\"", base::nullopt},
    {"0x48 in string", "\"\\H\"", base::nullopt},
    {"0x49 in string", "\"\\I\"", base::nullopt},
    {"0x4a in string", "\"\\J\"", base::nullopt},
    {"0x4b in string", "\"\\K\"", base::nullopt},
    {"0x4c in string", "\"\\L\"", base::nullopt},
    {"0x4d in string", "\"\\M\"", base::nullopt},
    {"0x4e in string", "\"\\N\"", base::nullopt},
    {"0x4f in string", "\"\\O\"", base::nullopt},
    {"0x50 in string", "\"\\P\"", base::nullopt},
    {"0x51 in string", "\"\\Q\"", base::nullopt},
    {"0x52 in string", "\"\\R\"", base::nullopt},
    {"0x53 in string", "\"\\S\"", base::nullopt},
    {"0x54 in string", "\"\\T\"", base::nullopt},
    {"0x55 in string", "\"\\U\"", base::nullopt},
    {"0x56 in string", "\"\\V\"", base::nullopt},
    {"0x57 in string", "\"\\W\"", base::nullopt},
    {"0x58 in string", "\"\\X\"", base::nullopt},
    {"0x59 in string", "\"\\Y\"", base::nullopt},
    {"0x5a in string", "\"\\Z\"", base::nullopt},
    {"0x5b in string", "\"\\[\"", base::nullopt},
    {"0x5c in string", "\"\\\\\"", {{Item("\\"), {}}}},
    {"0x5d in string", "\"\\]\"", base::nullopt},
    {"0x5e in string", "\"\\^\"", base::nullopt},
    {"0x5f in string", "\"\\_\"", base::nullopt},
    {"0x60 in string", "\"\\`\"", base::nullopt},
    {"0x61 in string", "\"\\a\"", base::nullopt},
    {"0x62 in string", "\"\\b\"", base::nullopt},
    {"0x63 in string", "\"\\c\"", base::nullopt},
    {"0x64 in string", "\"\\d\"", base::nullopt},
    {"0x65 in string", "\"\\e\"", base::nullopt},
    {"0x66 in string", "\"\\f\"", base::nullopt},
    {"0x67 in string", "\"\\g\"", base::nullopt},
    {"0x68 in string", "\"\\h\"", base::nullopt},
    {"0x69 in string", "\"\\i\"", base::nullopt},
    {"0x6a in string", "\"\\j\"", base::nullopt},
    {"0x6b in string", "\"\\k\"", base::nullopt},
    {"0x6c in string", "\"\\l\"", base::nullopt},
    {"0x6d in string", "\"\\m\"", base::nullopt},
    {"0x6e in string", "\"\\n\"", base::nullopt},
    {"0x6f in string", "\"\\o\"", base::nullopt},
    {"0x70 in string", "\"\\p\"", base::nullopt},
    {"0x71 in string", "\"\\q\"", base::nullopt},
    {"0x72 in string", "\"\\r\"", base::nullopt},
    {"0x73 in string", "\"\\s\"", base::nullopt},
    {"0x74 in string", "\"\\t\"", base::nullopt},
    {"0x75 in string", "\"\\u\"", base::nullopt},
    {"0x76 in string", "\"\\v\"", base::nullopt},
    {"0x77 in string", "\"\\w\"", base::nullopt},
    {"0x78 in string", "\"\\x\"", base::nullopt},
    {"0x79 in string", "\"\\y\"", base::nullopt},
    {"0x7a in string", "\"\\z\"", base::nullopt},
    {"0x7b in string", "\"\\{\"", base::nullopt},
    {"0x7c in string", "\"\\|\"", base::nullopt},
    {"0x7d in string", "\"\\}\"", base::nullopt},
    {"0x7e in string", "\"\\~\"", base::nullopt},
    {"0x7f in string", "\"\\\177\"", base::nullopt},
    {"basic string", "\"foo bar\"", {{Item("foo bar"), {}}}},
    {"empty string", "\"\"", {{Item(""), {}}}},
    {"long string",
     "\"foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo "
     "foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo "
     "foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo "
     "foo foo foo foo foo foo foo foo foo foo foo foo \"",
     {{Item("foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo "
            "foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo "
            "foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo "
            "foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo foo "
            "foo "),
       {}}}},
    {"whitespace string", "\"   \"", {{Item("   "), {}}}},
    {"non-ascii string", "\"f\374\374\"", base::nullopt},
    {"tab in string", "\"\\t\"", base::nullopt},
    {"newline in string", "\" \\n \"", base::nullopt},
    {"single quoted string", "'foo'", base::nullopt},
    {"unbalanced string", "\"foo", base::nullopt},
    {"string quoting",
     "\"foo \\\"bar\\\" \\\\ baz\"",
     {{Item("foo \"bar\" \\ baz"), {}}}},
    {"bad string quoting", "\"foo \\,\"", base::nullopt},
    {"ending string quote", "\"foo \\\"", base::nullopt},
    {"abruptly ending string quote", "\"foo \\", base::nullopt},
    {"0x01 in token", "a\001a", base::nullopt},
    {"0x02 in token", "a\002a", base::nullopt},
    {"0x03 in token", "a\003a", base::nullopt},
    {"0x04 in token", "a\004a", base::nullopt},
    {"0x05 in token", "a\005a", base::nullopt},
    {"0x06 in token", "a\006a", base::nullopt},
    {"0x07 in token", "a\aa", base::nullopt},
    {"0x08 in token", "a\ba", base::nullopt},
    {"0x09 in token", "a\ta", base::nullopt},
    {"0x0a in token", "a\na", base::nullopt},
    {"0x0b in token", "a\va", base::nullopt},
    {"0x0c in token", "a\fa", base::nullopt},
    {"0x0d in token", "a\ra", base::nullopt},
    {"0x0e in token", "a\016a", base::nullopt},
    {"0x0f in token", "a\017a", base::nullopt},
    {"0x10 in token", "a\020a", base::nullopt},
    {"0x11 in token", "a\021a", base::nullopt},
    {"0x12 in token", "a\022a", base::nullopt},
    {"0x13 in token", "a\023a", base::nullopt},
    {"0x14 in token", "a\024a", base::nullopt},
    {"0x15 in token", "a\025a", base::nullopt},
    {"0x16 in token", "a\026a", base::nullopt},
    {"0x17 in token", "a\027a", base::nullopt},
    {"0x18 in token", "a\030a", base::nullopt},
    {"0x19 in token", "a\031a", base::nullopt},
    {"0x1a in token", "a\032a", base::nullopt},
    {"0x1b in token", "a\033a", base::nullopt},
    {"0x1c in token", "a\034a", base::nullopt},
    {"0x1d in token", "a\035a", base::nullopt},
    {"0x1e in token", "a\036a", base::nullopt},
    {"0x1f in token", "a\037a", base::nullopt},
    {"0x20 in token", "a a", base::nullopt},
    {"0x21 in token", "a!a", {{Item("a!a", Item::kTokenType), {}}}},
    {"0x22 in token", "a\"a", base::nullopt},
    {"0x23 in token", "a#a", {{Item("a#a", Item::kTokenType), {}}}},
    {"0x24 in token", "a$a", {{Item("a$a", Item::kTokenType), {}}}},
    {"0x25 in token", "a%a", {{Item("a%a", Item::kTokenType), {}}}},
    {"0x26 in token", "a&a", {{Item("a&a", Item::kTokenType), {}}}},
    {"0x27 in token", "a'a", {{Item("a'a", Item::kTokenType), {}}}},
    {"0x28 in token", "a(a", base::nullopt},
    {"0x29 in token", "a)a", base::nullopt},
    {"0x2a in token", "a*a", {{Item("a*a", Item::kTokenType), {}}}},
    {"0x2b in token", "a+a", {{Item("a+a", Item::kTokenType), {}}}},
    {"0x2c in token", "a,a", base::nullopt},
    {"0x2d in token", "a-a", {{Item("a-a", Item::kTokenType), {}}}},
    {"0x2e in token", "a.a", {{Item("a.a", Item::kTokenType), {}}}},
    {"0x2f in token", "a/a", {{Item("a/a", Item::kTokenType), {}}}},
    {"0x30 in token", "a0a", {{Item("a0a", Item::kTokenType), {}}}},
    {"0x31 in token", "a1a", {{Item("a1a", Item::kTokenType), {}}}},
    {"0x32 in token", "a2a", {{Item("a2a", Item::kTokenType), {}}}},
    {"0x33 in token", "a3a", {{Item("a3a", Item::kTokenType), {}}}},
    {"0x34 in token", "a4a", {{Item("a4a", Item::kTokenType), {}}}},
    {"0x35 in token", "a5a", {{Item("a5a", Item::kTokenType), {}}}},
    {"0x36 in token", "a6a", {{Item("a6a", Item::kTokenType), {}}}},
    {"0x37 in token", "a7a", {{Item("a7a", Item::kTokenType), {}}}},
    {"0x38 in token", "a8a", {{Item("a8a", Item::kTokenType), {}}}},
    {"0x39 in token", "a9a", {{Item("a9a", Item::kTokenType), {}}}},
    {"0x3a in token", "a:a", {{Item("a:a", Item::kTokenType), {}}}},
    {"0x3b in token",
     "a;a",
     {{Item("a", Item::kTokenType), {BooleanParam("a", true)}}}},
    {"0x3c in token", "a<a", base::nullopt},
    {"0x3d in token", "a=a", base::nullopt},
    {"0x3e in token", "a>a", base::nullopt},
    {"0x3f in token", "a?a", base::nullopt},
    {"0x40 in token", "a@a", base::nullopt},
    {"0x41 in token", "aAa", {{Item("aAa", Item::kTokenType), {}}}},
    {"0x42 in token", "aBa", {{Item("aBa", Item::kTokenType), {}}}},
    {"0x43 in token", "aCa", {{Item("aCa", Item::kTokenType), {}}}},
    {"0x44 in token", "aDa", {{Item("aDa", Item::kTokenType), {}}}},
    {"0x45 in token", "aEa", {{Item("aEa", Item::kTokenType), {}}}},
    {"0x46 in token", "aFa", {{Item("aFa", Item::kTokenType), {}}}},
    {"0x47 in token", "aGa", {{Item("aGa", Item::kTokenType), {}}}},
    {"0x48 in token", "aHa", {{Item("aHa", Item::kTokenType), {}}}},
    {"0x49 in token", "aIa", {{Item("aIa", Item::kTokenType), {}}}},
    {"0x4a in token", "aJa", {{Item("aJa", Item::kTokenType), {}}}},
    {"0x4b in token", "aKa", {{Item("aKa", Item::kTokenType), {}}}},
    {"0x4c in token", "aLa", {{Item("aLa", Item::kTokenType), {}}}},
    {"0x4d in token", "aMa", {{Item("aMa", Item::kTokenType), {}}}},
    {"0x4e in token", "aNa", {{Item("aNa", Item::kTokenType), {}}}},
    {"0x4f in token", "aOa", {{Item("aOa", Item::kTokenType), {}}}},
    {"0x50 in token", "aPa", {{Item("aPa", Item::kTokenType), {}}}},
    {"0x51 in token", "aQa", {{Item("aQa", Item::kTokenType), {}}}},
    {"0x52 in token", "aRa", {{Item("aRa", Item::kTokenType), {}}}},
    {"0x53 in token", "aSa", {{Item("aSa", Item::kTokenType), {}}}},
    {"0x54 in token", "aTa", {{Item("aTa", Item::kTokenType), {}}}},
    {"0x55 in token", "aUa", {{Item("aUa", Item::kTokenType), {}}}},
    {"0x56 in token", "aVa", {{Item("aVa", Item::kTokenType), {}}}},
    {"0x57 in token", "aWa", {{Item("aWa", Item::kTokenType), {}}}},
    {"0x58 in token", "aXa", {{Item("aXa", Item::kTokenType), {}}}},
    {"0x59 in token", "aYa", {{Item("aYa", Item::kTokenType), {}}}},
    {"0x5a in token", "aZa", {{Item("aZa", Item::kTokenType), {}}}},
    {"0x5b in token", "a[a", base::nullopt},
    {"0x5c in token", "a\\a", base::nullopt},
    {"0x5d in token", "a]a", base::nullopt},
    {"0x5e in token", "a^a", {{Item("a^a", Item::kTokenType), {}}}},
    {"0x5f in token", "a_a", {{Item("a_a", Item::kTokenType), {}}}},
    {"0x60 in token", "a`a", {{Item("a`a", Item::kTokenType), {}}}},
    {"0x61 in token", "aaa", {{Item("aaa", Item::kTokenType), {}}}},
    {"0x62 in token", "aba", {{Item("aba", Item::kTokenType), {}}}},
    {"0x63 in token", "aca", {{Item("aca", Item::kTokenType), {}}}},
    {"0x64 in token", "ada", {{Item("ada", Item::kTokenType), {}}}},
    {"0x65 in token", "aea", {{Item("aea", Item::kTokenType), {}}}},
    {"0x66 in token", "afa", {{Item("afa", Item::kTokenType), {}}}},
    {"0x67 in token", "aga", {{Item("aga", Item::kTokenType), {}}}},
    {"0x68 in token", "aha", {{Item("aha", Item::kTokenType), {}}}},
    {"0x69 in token", "aia", {{Item("aia", Item::kTokenType), {}}}},
    {"0x6a in token", "aja", {{Item("aja", Item::kTokenType), {}}}},
    {"0x6b in token", "aka", {{Item("aka", Item::kTokenType), {}}}},
    {"0x6c in token", "ala", {{Item("ala", Item::kTokenType), {}}}},
    {"0x6d in token", "ama", {{Item("ama", Item::kTokenType), {}}}},
    {"0x6e in token", "ana", {{Item("ana", Item::kTokenType), {}}}},
    {"0x6f in token", "aoa", {{Item("aoa", Item::kTokenType), {}}}},
    {"0x70 in token", "apa", {{Item("apa", Item::kTokenType), {}}}},
    {"0x71 in token", "aqa", {{Item("aqa", Item::kTokenType), {}}}},
    {"0x72 in token", "ara", {{Item("ara", Item::kTokenType), {}}}},
    {"0x73 in token", "asa", {{Item("asa", Item::kTokenType), {}}}},
    {"0x74 in token", "ata", {{Item("ata", Item::kTokenType), {}}}},
    {"0x75 in token", "aua", {{Item("aua", Item::kTokenType), {}}}},
    {"0x76 in token", "ava", {{Item("ava", Item::kTokenType), {}}}},
    {"0x77 in token", "awa", {{Item("awa", Item::kTokenType), {}}}},
    {"0x78 in token", "axa", {{Item("axa", Item::kTokenType), {}}}},
    {"0x79 in token", "aya", {{Item("aya", Item::kTokenType), {}}}},
    {"0x7a in token", "aza", {{Item("aza", Item::kTokenType), {}}}},
    {"0x7b in token", "a{a", base::nullopt},
    {"0x7c in token", "a|a", {{Item("a|a", Item::kTokenType), {}}}},
    {"0x7d in token", "a}a", base::nullopt},
    {"0x7e in token", "a~a", {{Item("a~a", Item::kTokenType), {}}}},
    {"0x7f in token", "a\177a", base::nullopt},
    {"0x01 starting an token", "\001a", base::nullopt},
    {"0x02 starting an token", "\002a", base::nullopt},
    {"0x03 starting an token", "\003a", base::nullopt},
    {"0x04 starting an token", "\004a", base::nullopt},
    {"0x05 starting an token", "\005a", base::nullopt},
    {"0x06 starting an token", "\006a", base::nullopt},
    {"0x07 starting an token", "\aa", base::nullopt},
    {"0x08 starting an token", "\ba", base::nullopt},
    {"0x09 starting an token", "\ta", base::nullopt},
    {"0x0a starting an token", "\na", base::nullopt},
    {"0x0b starting an token", "\va", base::nullopt},
    {"0x0c starting an token", "\fa", base::nullopt},
    {"0x0d starting an token", "\ra", base::nullopt},
    {"0x0e starting an token", "\016a", base::nullopt},
    {"0x0f starting an token", "\017a", base::nullopt},
    {"0x10 starting an token", "\020a", base::nullopt},
    {"0x11 starting an token", "\021a", base::nullopt},
    {"0x12 starting an token", "\022a", base::nullopt},
    {"0x13 starting an token", "\023a", base::nullopt},
    {"0x14 starting an token", "\024a", base::nullopt},
    {"0x15 starting an token", "\025a", base::nullopt},
    {"0x16 starting an token", "\026a", base::nullopt},
    {"0x17 starting an token", "\027a", base::nullopt},
    {"0x18 starting an token", "\030a", base::nullopt},
    {"0x19 starting an token", "\031a", base::nullopt},
    {"0x1a starting an token", "\032a", base::nullopt},
    {"0x1b starting an token", "\033a", base::nullopt},
    {"0x1c starting an token", "\034a", base::nullopt},
    {"0x1d starting an token", "\035a", base::nullopt},
    {"0x1e starting an token", "\036a", base::nullopt},
    {"0x1f starting an token", "\037a", base::nullopt},
    {"0x20 starting an token", " a", {{Item("a", Item::kTokenType), {}}}, "a"},
    {"0x21 starting an token", "!a", base::nullopt},
    {"0x22 starting an token", "\"a", base::nullopt},
    {"0x23 starting an token", "#a", base::nullopt},
    {"0x24 starting an token", "$a", base::nullopt},
    {"0x25 starting an token", "%a", base::nullopt},
    {"0x26 starting an token", "&a", base::nullopt},
    {"0x27 starting an token", "'a", base::nullopt},
    {"0x28 starting an token", "(a", base::nullopt},
    {"0x29 starting an token", ")a", base::nullopt},
    {"0x2a starting an token", "*a", {{Item("*a", Item::kTokenType), {}}}},
    {"0x2b starting an token", "+a", base::nullopt},
    {"0x2c starting an token", ",a", base::nullopt},
    {"0x2d starting an token", "-a", base::nullopt},
    {"0x2e starting an token", ".a", base::nullopt},
    {"0x2f starting an token", "/a", base::nullopt},
    {"0x30 starting an token", "0a", base::nullopt},
    {"0x31 starting an token", "1a", base::nullopt},
    {"0x32 starting an token", "2a", base::nullopt},
    {"0x33 starting an token", "3a", base::nullopt},
    {"0x34 starting an token", "4a", base::nullopt},
    {"0x35 starting an token", "5a", base::nullopt},
    {"0x36 starting an token", "6a", base::nullopt},
    {"0x37 starting an token", "7a", base::nullopt},
    {"0x38 starting an token", "8a", base::nullopt},
    {"0x39 starting an token", "9a", base::nullopt},
    {"0x3a starting an token", ":a", base::nullopt},
    {"0x3b starting an token", ";a", base::nullopt},
    {"0x3c starting an token", "<a", base::nullopt},
    {"0x3d starting an token", "=a", base::nullopt},
    {"0x3e starting an token", ">a", base::nullopt},
    {"0x3f starting an token", "?a", base::nullopt},
    {"0x40 starting an token", "@a", base::nullopt},
    {"0x41 starting an token", "Aa", {{Item("Aa", Item::kTokenType), {}}}},
    {"0x42 starting an token", "Ba", {{Item("Ba", Item::kTokenType), {}}}},
    {"0x43 starting an token", "Ca", {{Item("Ca", Item::kTokenType), {}}}},
    {"0x44 starting an token", "Da", {{Item("Da", Item::kTokenType), {}}}},
    {"0x45 starting an token", "Ea", {{Item("Ea", Item::kTokenType), {}}}},
    {"0x46 starting an token", "Fa", {{Item("Fa", Item::kTokenType), {}}}},
    {"0x47 starting an token", "Ga", {{Item("Ga", Item::kTokenType), {}}}},
    {"0x48 starting an token", "Ha", {{Item("Ha", Item::kTokenType), {}}}},
    {"0x49 starting an token", "Ia", {{Item("Ia", Item::kTokenType), {}}}},
    {"0x4a starting an token", "Ja", {{Item("Ja", Item::kTokenType), {}}}},
    {"0x4b starting an token", "Ka", {{Item("Ka", Item::kTokenType), {}}}},
    {"0x4c starting an token", "La", {{Item("La", Item::kTokenType), {}}}},
    {"0x4d starting an token", "Ma", {{Item("Ma", Item::kTokenType), {}}}},
    {"0x4e starting an token", "Na", {{Item("Na", Item::kTokenType), {}}}},
    {"0x4f starting an token", "Oa", {{Item("Oa", Item::kTokenType), {}}}},
    {"0x50 starting an token", "Pa", {{Item("Pa", Item::kTokenType), {}}}},
    {"0x51 starting an token", "Qa", {{Item("Qa", Item::kTokenType), {}}}},
    {"0x52 starting an token", "Ra", {{Item("Ra", Item::kTokenType), {}}}},
    {"0x53 starting an token", "Sa", {{Item("Sa", Item::kTokenType), {}}}},
    {"0x54 starting an token", "Ta", {{Item("Ta", Item::kTokenType), {}}}},
    {"0x55 starting an token", "Ua", {{Item("Ua", Item::kTokenType), {}}}},
    {"0x56 starting an token", "Va", {{Item("Va", Item::kTokenType), {}}}},
    {"0x57 starting an token", "Wa", {{Item("Wa", Item::kTokenType), {}}}},
    {"0x58 starting an token", "Xa", {{Item("Xa", Item::kTokenType), {}}}},
    {"0x59 starting an token", "Ya", {{Item("Ya", Item::kTokenType), {}}}},
    {"0x5a starting an token", "Za", {{Item("Za", Item::kTokenType), {}}}},
    {"0x5b starting an token", "[a", base::nullopt},
    {"0x5c starting an token", "\\a", base::nullopt},
    {"0x5d starting an token", "]a", base::nullopt},
    {"0x5e starting an token", "^a", base::nullopt},
    {"0x5f starting an token", "_a", base::nullopt},
    {"0x60 starting an token", "`a", base::nullopt},
    {"0x61 starting an token", "aa", {{Item("aa", Item::kTokenType), {}}}},
    {"0x62 starting an token", "ba", {{Item("ba", Item::kTokenType), {}}}},
    {"0x63 starting an token", "ca", {{Item("ca", Item::kTokenType), {}}}},
    {"0x64 starting an token", "da", {{Item("da", Item::kTokenType), {}}}},
    {"0x65 starting an token", "ea", {{Item("ea", Item::kTokenType), {}}}},
    {"0x66 starting an token", "fa", {{Item("fa", Item::kTokenType), {}}}},
    {"0x67 starting an token", "ga", {{Item("ga", Item::kTokenType), {}}}},
    {"0x68 starting an token", "ha", {{Item("ha", Item::kTokenType), {}}}},
    {"0x69 starting an token", "ia", {{Item("ia", Item::kTokenType), {}}}},
    {"0x6a starting an token", "ja", {{Item("ja", Item::kTokenType), {}}}},
    {"0x6b starting an token", "ka", {{Item("ka", Item::kTokenType), {}}}},
    {"0x6c starting an token", "la", {{Item("la", Item::kTokenType), {}}}},
    {"0x6d starting an token", "ma", {{Item("ma", Item::kTokenType), {}}}},
    {"0x6e starting an token", "na", {{Item("na", Item::kTokenType), {}}}},
    {"0x6f starting an token", "oa", {{Item("oa", Item::kTokenType), {}}}},
    {"0x70 starting an token", "pa", {{Item("pa", Item::kTokenType), {}}}},
    {"0x71 starting an token", "qa", {{Item("qa", Item::kTokenType), {}}}},
    {"0x72 starting an token", "ra", {{Item("ra", Item::kTokenType), {}}}},
    {"0x73 starting an token", "sa", {{Item("sa", Item::kTokenType), {}}}},
    {"0x74 starting an token", "ta", {{Item("ta", Item::kTokenType), {}}}},
    {"0x75 starting an token", "ua", {{Item("ua", Item::kTokenType), {}}}},
    {"0x76 starting an token", "va", {{Item("va", Item::kTokenType), {}}}},
    {"0x77 starting an token", "wa", {{Item("wa", Item::kTokenType), {}}}},
    {"0x78 starting an token", "xa", {{Item("xa", Item::kTokenType), {}}}},
    {"0x79 starting an token", "ya", {{Item("ya", Item::kTokenType), {}}}},
    {"0x7a starting an token", "za", {{Item("za", Item::kTokenType), {}}}},
    {"0x7b starting an token", "{a", base::nullopt},
    {"0x7c starting an token", "|a", base::nullopt},
    {"0x7d starting an token", "}a", base::nullopt},
    {"0x7e starting an token", "~a", base::nullopt},
    {"0x7f starting an token", "\177a", base::nullopt},
    {"basic token - item",
     "a_b-c.d3:f%00/*",
     {{Item("a_b-c.d3:f%00/*", Item::kTokenType), {}}}},
    {"token with capitals - item",
     "fooBar",
     {{Item("fooBar", Item::kTokenType), {}}}},
    {"token starting with capitals - item",
     "FooBar",
     {{Item("FooBar", Item::kTokenType), {}}}},
    {"too big postive integer - serialize",
     nullptr,
     {{Integer(1000000000000000), {}}}},
    {"too big negative integer - serialize",
     nullptr,
     {{Integer(-1000000000000000), {}}}},
    {"too big postive decimal - serialize",
     nullptr,
     {{Item(1000000000000.000000), {}}}},
    {"too big negative decimal - serialize",
     nullptr,
     {{Item(-1000000000000.000000), {}}}},
    {"round positive odd decimal - serialize",
     nullptr,
     {{Item(0.001500), {}}},
     "0.002"},
    {"round positive even decimal - serialize",
     nullptr,
     {{Item(0.002500), {}}},
     "0.002"},
    {"round negative odd decimal - serialize",
     nullptr,
     {{Item(-0.001500), {}}},
     "-0.002"},
    {"round negative even decimal - serialize",
     nullptr,
     {{Item(-0.002500), {}}},
     "-0.002"},
    {"decimal round up to integer part - serialize",
     nullptr,
     {{Item(9.999500), {}}},
     "10.0"},
    {"0x01 in string - serialise only", nullptr, {{Item("\001"), {}}}},
    {"0x02 in string - serialise only", nullptr, {{Item("\002"), {}}}},
    {"0x03 in string - serialise only", nullptr, {{Item("\003"), {}}}},
    {"0x04 in string - serialise only", nullptr, {{Item("\004"), {}}}},
    {"0x05 in string - serialise only", nullptr, {{Item("\005"), {}}}},
    {"0x06 in string - serialise only", nullptr, {{Item("\006"), {}}}},
    {"0x07 in string - serialise only", nullptr, {{Item("\a"), {}}}},
    {"0x08 in string - serialise only", nullptr, {{Item("\b"), {}}}},
    {"0x09 in string - serialise only", nullptr, {{Item("\t"), {}}}},
    {"0x0a in string - serialise only", nullptr, {{Item("\n"), {}}}},
    {"0x0b in string - serialise only", nullptr, {{Item("\v"), {}}}},
    {"0x0c in string - serialise only", nullptr, {{Item("\f"), {}}}},
    {"0x0d in string - serialise only", nullptr, {{Item("\r"), {}}}},
    {"0x0e in string - serialise only", nullptr, {{Item("\016"), {}}}},
    {"0x0f in string - serialise only", nullptr, {{Item("\017"), {}}}},
    {"0x10 in string - serialise only", nullptr, {{Item("\020"), {}}}},
    {"0x11 in string - serialise only", nullptr, {{Item("\021"), {}}}},
    {"0x12 in string - serialise only", nullptr, {{Item("\022"), {}}}},
    {"0x13 in string - serialise only", nullptr, {{Item("\023"), {}}}},
    {"0x14 in string - serialise only", nullptr, {{Item("\024"), {}}}},
    {"0x15 in string - serialise only", nullptr, {{Item("\025"), {}}}},
    {"0x16 in string - serialise only", nullptr, {{Item("\026"), {}}}},
    {"0x17 in string - serialise only", nullptr, {{Item("\027"), {}}}},
    {"0x18 in string - serialise only", nullptr, {{Item("\030"), {}}}},
    {"0x19 in string - serialise only", nullptr, {{Item("\031"), {}}}},
    {"0x1a in string - serialise only", nullptr, {{Item("\032"), {}}}},
    {"0x1b in string - serialise only", nullptr, {{Item("\033"), {}}}},
    {"0x1c in string - serialise only", nullptr, {{Item("\034"), {}}}},
    {"0x1d in string - serialise only", nullptr, {{Item("\035"), {}}}},
    {"0x1e in string - serialise only", nullptr, {{Item("\036"), {}}}},
    {"0x1f in string - serialise only", nullptr, {{Item("\037"), {}}}},
    {"0x7f in string - serialise only", nullptr, {{Item("\177"), {}}}},
    {"0x01 in token - serialise only",
     nullptr,
     {{Item("a\001a", Item::kTokenType), {}}}},
    {"0x02 in token - serialise only",
     nullptr,
     {{Item("a\002a", Item::kTokenType), {}}}},
    {"0x03 in token - serialise only",
     nullptr,
     {{Item("a\003a", Item::kTokenType), {}}}},
    {"0x04 in token - serialise only",
     nullptr,
     {{Item("a\004a", Item::kTokenType), {}}}},
    {"0x05 in token - serialise only",
     nullptr,
     {{Item("a\005a", Item::kTokenType), {}}}},
    {"0x06 in token - serialise only",
     nullptr,
     {{Item("a\006a", Item::kTokenType), {}}}},
    {"0x07 in token - serialise only",
     nullptr,
     {{Item("a\aa", Item::kTokenType), {}}}},
    {"0x08 in token - serialise only",
     nullptr,
     {{Item("a\ba", Item::kTokenType), {}}}},
    {"0x09 in token - serialise only",
     nullptr,
     {{Item("a\ta", Item::kTokenType), {}}}},
    {"0x0a in token - serialise only",
     nullptr,
     {{Item("a\na", Item::kTokenType), {}}}},
    {"0x0b in token - serialise only",
     nullptr,
     {{Item("a\va", Item::kTokenType), {}}}},
    {"0x0c in token - serialise only",
     nullptr,
     {{Item("a\fa", Item::kTokenType), {}}}},
    {"0x0d in token - serialise only",
     nullptr,
     {{Item("a\ra", Item::kTokenType), {}}}},
    {"0x0e in token - serialise only",
     nullptr,
     {{Item("a\016a", Item::kTokenType), {}}}},
    {"0x0f in token - serialise only",
     nullptr,
     {{Item("a\017a", Item::kTokenType), {}}}},
    {"0x10 in token - serialise only",
     nullptr,
     {{Item("a\020a", Item::kTokenType), {}}}},
    {"0x11 in token - serialise only",
     nullptr,
     {{Item("a\021a", Item::kTokenType), {}}}},
    {"0x12 in token - serialise only",
     nullptr,
     {{Item("a\022a", Item::kTokenType), {}}}},
    {"0x13 in token - serialise only",
     nullptr,
     {{Item("a\023a", Item::kTokenType), {}}}},
    {"0x14 in token - serialise only",
     nullptr,
     {{Item("a\024a", Item::kTokenType), {}}}},
    {"0x15 in token - serialise only",
     nullptr,
     {{Item("a\025a", Item::kTokenType), {}}}},
    {"0x16 in token - serialise only",
     nullptr,
     {{Item("a\026a", Item::kTokenType), {}}}},
    {"0x17 in token - serialise only",
     nullptr,
     {{Item("a\027a", Item::kTokenType), {}}}},
    {"0x18 in token - serialise only",
     nullptr,
     {{Item("a\030a", Item::kTokenType), {}}}},
    {"0x19 in token - serialise only",
     nullptr,
     {{Item("a\031a", Item::kTokenType), {}}}},
    {"0x1a in token - serialise only",
     nullptr,
     {{Item("a\032a", Item::kTokenType), {}}}},
    {"0x1b in token - serialise only",
     nullptr,
     {{Item("a\033a", Item::kTokenType), {}}}},
    {"0x1c in token - serialise only",
     nullptr,
     {{Item("a\034a", Item::kTokenType), {}}}},
    {"0x1d in token - serialise only",
     nullptr,
     {{Item("a\035a", Item::kTokenType), {}}}},
    {"0x1e in token - serialise only",
     nullptr,
     {{Item("a\036a", Item::kTokenType), {}}}},
    {"0x1f in token - serialise only",
     nullptr,
     {{Item("a\037a", Item::kTokenType), {}}}},
    {"0x20 in token - serialise only",
     nullptr,
     {{Item("a a", Item::kTokenType), {}}}},
    {"0x22 in token - serialise only",
     nullptr,
     {{Item("a\"a", Item::kTokenType), {}}}},
    {"0x28 in token - serialise only",
     nullptr,
     {{Item("a(a", Item::kTokenType), {}}}},
    {"0x29 in token - serialise only",
     nullptr,
     {{Item("a)a", Item::kTokenType), {}}}},
    {"0x2c in token - serialise only",
     nullptr,
     {{Item("a,a", Item::kTokenType), {}}}},
    {"0x3b in token - serialise only",
     nullptr,
     {{Item("a;a", Item::kTokenType), {}}}},
    {"0x3c in token - serialise only",
     nullptr,
     {{Item("a<a", Item::kTokenType), {}}}},
    {"0x3d in token - serialise only",
     nullptr,
     {{Item("a=a", Item::kTokenType), {}}}},
    {"0x3e in token - serialise only",
     nullptr,
     {{Item("a>a", Item::kTokenType), {}}}},
    {"0x3f in token - serialise only",
     nullptr,
     {{Item("a?a", Item::kTokenType), {}}}},
    {"0x40 in token - serialise only",
     nullptr,
     {{Item("a@a", Item::kTokenType), {}}}},
    {"0x5b in token - serialise only",
     nullptr,
     {{Item("a[a", Item::kTokenType), {}}}},
    {"0x5c in token - serialise only",
     nullptr,
     {{Item("a\\a", Item::kTokenType), {}}}},
    {"0x5d in token - serialise only",
     nullptr,
     {{Item("a]a", Item::kTokenType), {}}}},
    {"0x7b in token - serialise only",
     nullptr,
     {{Item("a{a", Item::kTokenType), {}}}},
    {"0x7d in token - serialise only",
     nullptr,
     {{Item("a}a", Item::kTokenType), {}}}},
    {"0x7f in token - serialise only",
     nullptr,
     {{Item("a\177a", Item::kTokenType), {}}}},
    {"0x01 starting a token - serialise only",
     nullptr,
     {{Item("\001a", Item::kTokenType), {}}}},
    {"0x02 starting a token - serialise only",
     nullptr,
     {{Item("\002a", Item::kTokenType), {}}}},
    {"0x03 starting a token - serialise only",
     nullptr,
     {{Item("\003a", Item::kTokenType), {}}}},
    {"0x04 starting a token - serialise only",
     nullptr,
     {{Item("\004a", Item::kTokenType), {}}}},
    {"0x05 starting a token - serialise only",
     nullptr,
     {{Item("\005a", Item::kTokenType), {}}}},
    {"0x06 starting a token - serialise only",
     nullptr,
     {{Item("\006a", Item::kTokenType), {}}}},
    {"0x07 starting a token - serialise only",
     nullptr,
     {{Item("\aa", Item::kTokenType), {}}}},
    {"0x08 starting a token - serialise only",
     nullptr,
     {{Item("\ba", Item::kTokenType), {}}}},
    {"0x09 starting a token - serialise only",
     nullptr,
     {{Item("\ta", Item::kTokenType), {}}}},
    {"0x0a starting a token - serialise only",
     nullptr,
     {{Item("\na", Item::kTokenType), {}}}},
    {"0x0b starting a token - serialise only",
     nullptr,
     {{Item("\va", Item::kTokenType), {}}}},
    {"0x0c starting a token - serialise only",
     nullptr,
     {{Item("\fa", Item::kTokenType), {}}}},
    {"0x0d starting a token - serialise only",
     nullptr,
     {{Item("\ra", Item::kTokenType), {}}}},
    {"0x0e starting a token - serialise only",
     nullptr,
     {{Item("\016a", Item::kTokenType), {}}}},
    {"0x0f starting a token - serialise only",
     nullptr,
     {{Item("\017a", Item::kTokenType), {}}}},
    {"0x10 starting a token - serialise only",
     nullptr,
     {{Item("\020a", Item::kTokenType), {}}}},
    {"0x11 starting a token - serialise only",
     nullptr,
     {{Item("\021a", Item::kTokenType), {}}}},
    {"0x12 starting a token - serialise only",
     nullptr,
     {{Item("\022a", Item::kTokenType), {}}}},
    {"0x13 starting a token - serialise only",
     nullptr,
     {{Item("\023a", Item::kTokenType), {}}}},
    {"0x14 starting a token - serialise only",
     nullptr,
     {{Item("\024a", Item::kTokenType), {}}}},
    {"0x15 starting a token - serialise only",
     nullptr,
     {{Item("\025a", Item::kTokenType), {}}}},
    {"0x16 starting a token - serialise only",
     nullptr,
     {{Item("\026a", Item::kTokenType), {}}}},
    {"0x17 starting a token - serialise only",
     nullptr,
     {{Item("\027a", Item::kTokenType), {}}}},
    {"0x18 starting a token - serialise only",
     nullptr,
     {{Item("\030a", Item::kTokenType), {}}}},
    {"0x19 starting a token - serialise only",
     nullptr,
     {{Item("\031a", Item::kTokenType), {}}}},
    {"0x1a starting a token - serialise only",
     nullptr,
     {{Item("\032a", Item::kTokenType), {}}}},
    {"0x1b starting a token - serialise only",
     nullptr,
     {{Item("\033a", Item::kTokenType), {}}}},
    {"0x1c starting a token - serialise only",
     nullptr,
     {{Item("\034a", Item::kTokenType), {}}}},
    {"0x1d starting a token - serialise only",
     nullptr,
     {{Item("\035a", Item::kTokenType), {}}}},
    {"0x1e starting a token - serialise only",
     nullptr,
     {{Item("\036a", Item::kTokenType), {}}}},
    {"0x1f starting a token - serialise only",
     nullptr,
     {{Item("\037a", Item::kTokenType), {}}}},
    {"0x20 starting a token - serialise only",
     nullptr,
     {{Item(" a", Item::kTokenType), {}}}},
    {"0x21 starting a token - serialise only",
     nullptr,
     {{Item("!a", Item::kTokenType), {}}}},
    {"0x22 starting a token - serialise only",
     nullptr,
     {{Item("\"a", Item::kTokenType), {}}}},
    {"0x23 starting a token - serialise only",
     nullptr,
     {{Item("#a", Item::kTokenType), {}}}},
    {"0x24 starting a token - serialise only",
     nullptr,
     {{Item("$a", Item::kTokenType), {}}}},
    {"0x25 starting a token - serialise only",
     nullptr,
     {{Item("%a", Item::kTokenType), {}}}},
    {"0x26 starting a token - serialise only",
     nullptr,
     {{Item("&a", Item::kTokenType), {}}}},
    {"0x27 starting a token - serialise only",
     nullptr,
     {{Item("'a", Item::kTokenType), {}}}},
    {"0x28 starting a token - serialise only",
     nullptr,
     {{Item("(a", Item::kTokenType), {}}}},
    {"0x29 starting a token - serialise only",
     nullptr,
     {{Item(")a", Item::kTokenType), {}}}},
    {"0x2b starting a token - serialise only",
     nullptr,
     {{Item("+a", Item::kTokenType), {}}}},
    {"0x2c starting a token - serialise only",
     nullptr,
     {{Item(",a", Item::kTokenType), {}}}},
    {"0x2d starting a token - serialise only",
     nullptr,
     {{Item("-a", Item::kTokenType), {}}}},
    {"0x2e starting a token - serialise only",
     nullptr,
     {{Item(".a", Item::kTokenType), {}}}},
    {"0x2f starting a token - serialise only",
     nullptr,
     {{Item("/a", Item::kTokenType), {}}}},
    {"0x30 starting a token - serialise only",
     nullptr,
     {{Item("0a", Item::kTokenType), {}}}},
    {"0x31 starting a token - serialise only",
     nullptr,
     {{Item("1a", Item::kTokenType), {}}}},
    {"0x32 starting a token - serialise only",
     nullptr,
     {{Item("2a", Item::kTokenType), {}}}},
    {"0x33 starting a token - serialise only",
     nullptr,
     {{Item("3a", Item::kTokenType), {}}}},
    {"0x34 starting a token - serialise only",
     nullptr,
     {{Item("4a", Item::kTokenType), {}}}},
    {"0x35 starting a token - serialise only",
     nullptr,
     {{Item("5a", Item::kTokenType), {}}}},
    {"0x36 starting a token - serialise only",
     nullptr,
     {{Item("6a", Item::kTokenType), {}}}},
    {"0x37 starting a token - serialise only",
     nullptr,
     {{Item("7a", Item::kTokenType), {}}}},
    {"0x38 starting a token - serialise only",
     nullptr,
     {{Item("8a", Item::kTokenType), {}}}},
    {"0x39 starting a token - serialise only",
     nullptr,
     {{Item("9a", Item::kTokenType), {}}}},
    {"0x3a starting a token - serialise only",
     nullptr,
     {{Item(":a", Item::kTokenType), {}}}},
    {"0x3b starting a token - serialise only",
     nullptr,
     {{Item(";a", Item::kTokenType), {}}}},
    {"0x3c starting a token - serialise only",
     nullptr,
     {{Item("<a", Item::kTokenType), {}}}},
    {"0x3d starting a token - serialise only",
     nullptr,
     {{Item("=a", Item::kTokenType), {}}}},
    {"0x3e starting a token - serialise only",
     nullptr,
     {{Item(">a", Item::kTokenType), {}}}},
    {"0x3f starting a token - serialise only",
     nullptr,
     {{Item("?a", Item::kTokenType), {}}}},
    {"0x40 starting a token - serialise only",
     nullptr,
     {{Item("@a", Item::kTokenType), {}}}},
    {"0x5b starting a token - serialise only",
     nullptr,
     {{Item("[a", Item::kTokenType), {}}}},
    {"0x5c starting a token - serialise only",
     nullptr,
     {{Item("\\a", Item::kTokenType), {}}}},
    {"0x5d starting a token - serialise only",
     nullptr,
     {{Item("]a", Item::kTokenType), {}}}},
    {"0x5e starting a token - serialise only",
     nullptr,
     {{Item("^a", Item::kTokenType), {}}}},
    {"0x5f starting a token - serialise only",
     nullptr,
     {{Item("_a", Item::kTokenType), {}}}},
    {"0x60 starting a token - serialise only",
     nullptr,
     {{Item("`a", Item::kTokenType), {}}}},
    {"0x7b starting a token - serialise only",
     nullptr,
     {{Item("{a", Item::kTokenType), {}}}},
    {"0x7c starting a token - serialise only",
     nullptr,
     {{Item("|a", Item::kTokenType), {}}}},
    {"0x7d starting a token - serialise only",
     nullptr,
     {{Item("}a", Item::kTokenType), {}}}},
    {"0x7e starting a token - serialise only",
     nullptr,
     {{Item("~a", Item::kTokenType), {}}}},
    {"0x7f starting a token - serialise only",
     nullptr,
     {{Item("\177a", Item::kTokenType), {}}}},
};

const struct ListTestCase {
  const char* name;
  const char* raw;
  const base::Optional<List> expected;  // nullopt if parse error is expected.
  const char* canonical;  // nullptr if parse error is expected, or if canonical
                          // format is identical to raw.
} list_test_cases[] = {
    {"tab separated dictionary", "a=1\t,\tb=2", base::nullopt},
    {"Example-StrListHeader",
     "\"foo\", \"bar\", \"It was the best of times.\"",
     {{{Item("foo"), {}},
       {Item("bar"), {}},
       {Item("It was the best of times."), {}}}}},
    {"Example-Hdr (list on one line)",
     "foo, bar",
     {{{Item("foo", Item::kTokenType), {}},
       {Item("bar", Item::kTokenType), {}}}}},
    {"Example-Hdr (list on two lines)",
     "foo, bar",
     {{{Item("foo", Item::kTokenType), {}},
       {Item("bar", Item::kTokenType), {}}}},
     "foo, bar"},
    {"Example-StrListListHeader",
     "(\"foo\" \"bar\"), (\"baz\"), (\"bat\" \"one\"), ()",
     {{{{{Item("foo"), {}}, {Item("bar"), {}}}, {}},
       {{{Item("baz"), {}}}, {}},
       {{{Item("bat"), {}}, {Item("one"), {}}}, {}},
       {std::vector<ParameterizedItem>(), {}}}}},
    {"Example-ListListParam",
     "(\"foo\"; a=1;b=2);lvl=5, (\"bar\" \"baz\");lvl=1",
     {{{{{Item("foo"), {Param("a", 1), Param("b", 2)}}}, {Param("lvl", 5)}},
       {{{Item("bar"), {}}, {Item("baz"), {}}}, {Param("lvl", 1)}}}},
     "(\"foo\";a=1;b=2);lvl=5, (\"bar\" \"baz\");lvl=1"},
    {"Example-ParamListHeader",
     "abc;a=1;b=2; cde_456, (ghi;jk=4 l);q=\"9\";r=w",
     {{{Item("abc", Item::kTokenType),
        {Param("a", 1), Param("b", 2), BooleanParam("cde_456", true)}},
       {{{Item("ghi", Item::kTokenType), {Param("jk", 4)}},
         {Item("l", Item::kTokenType), {}}},
        {Param("q", "9"), TokenParam("r", "w")}}}},
     "abc;a=1;b=2;cde_456, (ghi;jk=4 l);q=\"9\";r=w"},
    {"0x01 in parameterised list key", "foo; a\001a=1", base::nullopt},
    {"0x02 in parameterised list key", "foo; a\002a=1", base::nullopt},
    {"0x03 in parameterised list key", "foo; a\003a=1", base::nullopt},
    {"0x04 in parameterised list key", "foo; a\004a=1", base::nullopt},
    {"0x05 in parameterised list key", "foo; a\005a=1", base::nullopt},
    {"0x06 in parameterised list key", "foo; a\006a=1", base::nullopt},
    {"0x07 in parameterised list key", "foo; a\aa=1", base::nullopt},
    {"0x08 in parameterised list key", "foo; a\ba=1", base::nullopt},
    {"0x09 in parameterised list key", "foo; a\ta=1", base::nullopt},
    {"0x0a in parameterised list key", "foo; a\na=1", base::nullopt},
    {"0x0b in parameterised list key", "foo; a\va=1", base::nullopt},
    {"0x0c in parameterised list key", "foo; a\fa=1", base::nullopt},
    {"0x0d in parameterised list key", "foo; a\ra=1", base::nullopt},
    {"0x0e in parameterised list key", "foo; a\016a=1", base::nullopt},
    {"0x0f in parameterised list key", "foo; a\017a=1", base::nullopt},
    {"0x10 in parameterised list key", "foo; a\020a=1", base::nullopt},
    {"0x11 in parameterised list key", "foo; a\021a=1", base::nullopt},
    {"0x12 in parameterised list key", "foo; a\022a=1", base::nullopt},
    {"0x13 in parameterised list key", "foo; a\023a=1", base::nullopt},
    {"0x14 in parameterised list key", "foo; a\024a=1", base::nullopt},
    {"0x15 in parameterised list key", "foo; a\025a=1", base::nullopt},
    {"0x16 in parameterised list key", "foo; a\026a=1", base::nullopt},
    {"0x17 in parameterised list key", "foo; a\027a=1", base::nullopt},
    {"0x18 in parameterised list key", "foo; a\030a=1", base::nullopt},
    {"0x19 in parameterised list key", "foo; a\031a=1", base::nullopt},
    {"0x1a in parameterised list key", "foo; a\032a=1", base::nullopt},
    {"0x1b in parameterised list key", "foo; a\033a=1", base::nullopt},
    {"0x1c in parameterised list key", "foo; a\034a=1", base::nullopt},
    {"0x1d in parameterised list key", "foo; a\035a=1", base::nullopt},
    {"0x1e in parameterised list key", "foo; a\036a=1", base::nullopt},
    {"0x1f in parameterised list key", "foo; a\037a=1", base::nullopt},
    {"0x20 in parameterised list key", "foo; a a=1", base::nullopt},
    {"0x21 in parameterised list key", "foo; a!a=1", base::nullopt},
    {"0x22 in parameterised list key", "foo; a\"a=1", base::nullopt},
    {"0x23 in parameterised list key", "foo; a#a=1", base::nullopt},
    {"0x24 in parameterised list key", "foo; a$a=1", base::nullopt},
    {"0x25 in parameterised list key", "foo; a%a=1", base::nullopt},
    {"0x26 in parameterised list key", "foo; a&a=1", base::nullopt},
    {"0x27 in parameterised list key", "foo; a'a=1", base::nullopt},
    {"0x28 in parameterised list key", "foo; a(a=1", base::nullopt},
    {"0x29 in parameterised list key", "foo; a)a=1", base::nullopt},
    {"0x2a in parameterised list key",
     "foo; a*a=1",
     {{{Item("foo", Item::kTokenType), {Param("a*a", 1)}}}},
     "foo;a*a=1"},
    {"0x2b in parameterised list key", "foo; a+a=1", base::nullopt},
    {"0x2c in parameterised list key", "foo; a,a=1", base::nullopt},
    {"0x2d in parameterised list key",
     "foo; a-a=1",
     {{{Item("foo", Item::kTokenType), {Param("a-a", 1)}}}},
     "foo;a-a=1"},
    {"0x2e in parameterised list key",
     "foo; a.a=1",
     {{{Item("foo", Item::kTokenType), {Param("a.a", 1)}}}},
     "foo;a.a=1"},
    {"0x2f in parameterised list key", "foo; a/a=1", base::nullopt},
    {"0x30 in parameterised list key",
     "foo; a0a=1",
     {{{Item("foo", Item::kTokenType), {Param("a0a", 1)}}}},
     "foo;a0a=1"},
    {"0x31 in parameterised list key",
     "foo; a1a=1",
     {{{Item("foo", Item::kTokenType), {Param("a1a", 1)}}}},
     "foo;a1a=1"},
    {"0x32 in parameterised list key",
     "foo; a2a=1",
     {{{Item("foo", Item::kTokenType), {Param("a2a", 1)}}}},
     "foo;a2a=1"},
    {"0x33 in parameterised list key",
     "foo; a3a=1",
     {{{Item("foo", Item::kTokenType), {Param("a3a", 1)}}}},
     "foo;a3a=1"},
    {"0x34 in parameterised list key",
     "foo; a4a=1",
     {{{Item("foo", Item::kTokenType), {Param("a4a", 1)}}}},
     "foo;a4a=1"},
    {"0x35 in parameterised list key",
     "foo; a5a=1",
     {{{Item("foo", Item::kTokenType), {Param("a5a", 1)}}}},
     "foo;a5a=1"},
    {"0x36 in parameterised list key",
     "foo; a6a=1",
     {{{Item("foo", Item::kTokenType), {Param("a6a", 1)}}}},
     "foo;a6a=1"},
    {"0x37 in parameterised list key",
     "foo; a7a=1",
     {{{Item("foo", Item::kTokenType), {Param("a7a", 1)}}}},
     "foo;a7a=1"},
    {"0x38 in parameterised list key",
     "foo; a8a=1",
     {{{Item("foo", Item::kTokenType), {Param("a8a", 1)}}}},
     "foo;a8a=1"},
    {"0x39 in parameterised list key",
     "foo; a9a=1",
     {{{Item("foo", Item::kTokenType), {Param("a9a", 1)}}}},
     "foo;a9a=1"},
    {"0x3a in parameterised list key", "foo; a:a=1", base::nullopt},
    {"0x3b in parameterised list key",
     "foo; a;a=1",
     {{{Item("foo", Item::kTokenType), {Param("a", 1)}}}},
     "foo;a=1"},
    {"0x3c in parameterised list key", "foo; a<a=1", base::nullopt},
    {"0x3d in parameterised list key", "foo; a=a=1", base::nullopt},
    {"0x3e in parameterised list key", "foo; a>a=1", base::nullopt},
    {"0x3f in parameterised list key", "foo; a?a=1", base::nullopt},
    {"0x40 in parameterised list key", "foo; a@a=1", base::nullopt},
    {"0x41 in parameterised list key", "foo; aAa=1", base::nullopt},
    {"0x42 in parameterised list key", "foo; aBa=1", base::nullopt},
    {"0x43 in parameterised list key", "foo; aCa=1", base::nullopt},
    {"0x44 in parameterised list key", "foo; aDa=1", base::nullopt},
    {"0x45 in parameterised list key", "foo; aEa=1", base::nullopt},
    {"0x46 in parameterised list key", "foo; aFa=1", base::nullopt},
    {"0x47 in parameterised list key", "foo; aGa=1", base::nullopt},
    {"0x48 in parameterised list key", "foo; aHa=1", base::nullopt},
    {"0x49 in parameterised list key", "foo; aIa=1", base::nullopt},
    {"0x4a in parameterised list key", "foo; aJa=1", base::nullopt},
    {"0x4b in parameterised list key", "foo; aKa=1", base::nullopt},
    {"0x4c in parameterised list key", "foo; aLa=1", base::nullopt},
    {"0x4d in parameterised list key", "foo; aMa=1", base::nullopt},
    {"0x4e in parameterised list key", "foo; aNa=1", base::nullopt},
    {"0x4f in parameterised list key", "foo; aOa=1", base::nullopt},
    {"0x50 in parameterised list key", "foo; aPa=1", base::nullopt},
    {"0x51 in parameterised list key", "foo; aQa=1", base::nullopt},
    {"0x52 in parameterised list key", "foo; aRa=1", base::nullopt},
    {"0x53 in parameterised list key", "foo; aSa=1", base::nullopt},
    {"0x54 in parameterised list key", "foo; aTa=1", base::nullopt},
    {"0x55 in parameterised list key", "foo; aUa=1", base::nullopt},
    {"0x56 in parameterised list key", "foo; aVa=1", base::nullopt},
    {"0x57 in parameterised list key", "foo; aWa=1", base::nullopt},
    {"0x58 in parameterised list key", "foo; aXa=1", base::nullopt},
    {"0x59 in parameterised list key", "foo; aYa=1", base::nullopt},
    {"0x5a in parameterised list key", "foo; aZa=1", base::nullopt},
    {"0x5b in parameterised list key", "foo; a[a=1", base::nullopt},
    {"0x5c in parameterised list key", "foo; a\\a=1", base::nullopt},
    {"0x5d in parameterised list key", "foo; a]a=1", base::nullopt},
    {"0x5e in parameterised list key", "foo; a^a=1", base::nullopt},
    {"0x5f in parameterised list key",
     "foo; a_a=1",
     {{{Item("foo", Item::kTokenType), {Param("a_a", 1)}}}},
     "foo;a_a=1"},
    {"0x60 in parameterised list key", "foo; a`a=1", base::nullopt},
    {"0x61 in parameterised list key",
     "foo; aaa=1",
     {{{Item("foo", Item::kTokenType), {Param("aaa", 1)}}}},
     "foo;aaa=1"},
    {"0x62 in parameterised list key",
     "foo; aba=1",
     {{{Item("foo", Item::kTokenType), {Param("aba", 1)}}}},
     "foo;aba=1"},
    {"0x63 in parameterised list key",
     "foo; aca=1",
     {{{Item("foo", Item::kTokenType), {Param("aca", 1)}}}},
     "foo;aca=1"},
    {"0x64 in parameterised list key",
     "foo; ada=1",
     {{{Item("foo", Item::kTokenType), {Param("ada", 1)}}}},
     "foo;ada=1"},
    {"0x65 in parameterised list key",
     "foo; aea=1",
     {{{Item("foo", Item::kTokenType), {Param("aea", 1)}}}},
     "foo;aea=1"},
    {"0x66 in parameterised list key",
     "foo; afa=1",
     {{{Item("foo", Item::kTokenType), {Param("afa", 1)}}}},
     "foo;afa=1"},
    {"0x67 in parameterised list key",
     "foo; aga=1",
     {{{Item("foo", Item::kTokenType), {Param("aga", 1)}}}},
     "foo;aga=1"},
    {"0x68 in parameterised list key",
     "foo; aha=1",
     {{{Item("foo", Item::kTokenType), {Param("aha", 1)}}}},
     "foo;aha=1"},
    {"0x69 in parameterised list key",
     "foo; aia=1",
     {{{Item("foo", Item::kTokenType), {Param("aia", 1)}}}},
     "foo;aia=1"},
    {"0x6a in parameterised list key",
     "foo; aja=1",
     {{{Item("foo", Item::kTokenType), {Param("aja", 1)}}}},
     "foo;aja=1"},
    {"0x6b in parameterised list key",
     "foo; aka=1",
     {{{Item("foo", Item::kTokenType), {Param("aka", 1)}}}},
     "foo;aka=1"},
    {"0x6c in parameterised list key",
     "foo; ala=1",
     {{{Item("foo", Item::kTokenType), {Param("ala", 1)}}}},
     "foo;ala=1"},
    {"0x6d in parameterised list key",
     "foo; ama=1",
     {{{Item("foo", Item::kTokenType), {Param("ama", 1)}}}},
     "foo;ama=1"},
    {"0x6e in parameterised list key",
     "foo; ana=1",
     {{{Item("foo", Item::kTokenType), {Param("ana", 1)}}}},
     "foo;ana=1"},
    {"0x6f in parameterised list key",
     "foo; aoa=1",
     {{{Item("foo", Item::kTokenType), {Param("aoa", 1)}}}},
     "foo;aoa=1"},
    {"0x70 in parameterised list key",
     "foo; apa=1",
     {{{Item("foo", Item::kTokenType), {Param("apa", 1)}}}},
     "foo;apa=1"},
    {"0x71 in parameterised list key",
     "foo; aqa=1",
     {{{Item("foo", Item::kTokenType), {Param("aqa", 1)}}}},
     "foo;aqa=1"},
    {"0x72 in parameterised list key",
     "foo; ara=1",
     {{{Item("foo", Item::kTokenType), {Param("ara", 1)}}}},
     "foo;ara=1"},
    {"0x73 in parameterised list key",
     "foo; asa=1",
     {{{Item("foo", Item::kTokenType), {Param("asa", 1)}}}},
     "foo;asa=1"},
    {"0x74 in parameterised list key",
     "foo; ata=1",
     {{{Item("foo", Item::kTokenType), {Param("ata", 1)}}}},
     "foo;ata=1"},
    {"0x75 in parameterised list key",
     "foo; aua=1",
     {{{Item("foo", Item::kTokenType), {Param("aua", 1)}}}},
     "foo;aua=1"},
    {"0x76 in parameterised list key",
     "foo; ava=1",
     {{{Item("foo", Item::kTokenType), {Param("ava", 1)}}}},
     "foo;ava=1"},
    {"0x77 in parameterised list key",
     "foo; awa=1",
     {{{Item("foo", Item::kTokenType), {Param("awa", 1)}}}},
     "foo;awa=1"},
    {"0x78 in parameterised list key",
     "foo; axa=1",
     {{{Item("foo", Item::kTokenType), {Param("axa", 1)}}}},
     "foo;axa=1"},
    {"0x79 in parameterised list key",
     "foo; aya=1",
     {{{Item("foo", Item::kTokenType), {Param("aya", 1)}}}},
     "foo;aya=1"},
    {"0x7a in parameterised list key",
     "foo; aza=1",
     {{{Item("foo", Item::kTokenType), {Param("aza", 1)}}}},
     "foo;aza=1"},
    {"0x7b in parameterised list key", "foo; a{a=1", base::nullopt},
    {"0x7c in parameterised list key", "foo; a|a=1", base::nullopt},
    {"0x7d in parameterised list key", "foo; a}a=1", base::nullopt},
    {"0x7e in parameterised list key", "foo; a~a=1", base::nullopt},
    {"0x7f in parameterised list key", "foo; a\177a=1", base::nullopt},
    {"0x01 starting a parameterised list key", "foo; \001a=1", base::nullopt},
    {"0x02 starting a parameterised list key", "foo; \002a=1", base::nullopt},
    {"0x03 starting a parameterised list key", "foo; \003a=1", base::nullopt},
    {"0x04 starting a parameterised list key", "foo; \004a=1", base::nullopt},
    {"0x05 starting a parameterised list key", "foo; \005a=1", base::nullopt},
    {"0x06 starting a parameterised list key", "foo; \006a=1", base::nullopt},
    {"0x07 starting a parameterised list key", "foo; \aa=1", base::nullopt},
    {"0x08 starting a parameterised list key", "foo; \ba=1", base::nullopt},
    {"0x09 starting a parameterised list key", "foo; \ta=1", base::nullopt},
    {"0x0a starting a parameterised list key", "foo; \na=1", base::nullopt},
    {"0x0b starting a parameterised list key", "foo; \va=1", base::nullopt},
    {"0x0c starting a parameterised list key", "foo; \fa=1", base::nullopt},
    {"0x0d starting a parameterised list key", "foo; \ra=1", base::nullopt},
    {"0x0e starting a parameterised list key", "foo; \016a=1", base::nullopt},
    {"0x0f starting a parameterised list key", "foo; \017a=1", base::nullopt},
    {"0x10 starting a parameterised list key", "foo; \020a=1", base::nullopt},
    {"0x11 starting a parameterised list key", "foo; \021a=1", base::nullopt},
    {"0x12 starting a parameterised list key", "foo; \022a=1", base::nullopt},
    {"0x13 starting a parameterised list key", "foo; \023a=1", base::nullopt},
    {"0x14 starting a parameterised list key", "foo; \024a=1", base::nullopt},
    {"0x15 starting a parameterised list key", "foo; \025a=1", base::nullopt},
    {"0x16 starting a parameterised list key", "foo; \026a=1", base::nullopt},
    {"0x17 starting a parameterised list key", "foo; \027a=1", base::nullopt},
    {"0x18 starting a parameterised list key", "foo; \030a=1", base::nullopt},
    {"0x19 starting a parameterised list key", "foo; \031a=1", base::nullopt},
    {"0x1a starting a parameterised list key", "foo; \032a=1", base::nullopt},
    {"0x1b starting a parameterised list key", "foo; \033a=1", base::nullopt},
    {"0x1c starting a parameterised list key", "foo; \034a=1", base::nullopt},
    {"0x1d starting a parameterised list key", "foo; \035a=1", base::nullopt},
    {"0x1e starting a parameterised list key", "foo; \036a=1", base::nullopt},
    {"0x1f starting a parameterised list key", "foo; \037a=1", base::nullopt},
    {"0x20 starting a parameterised list key",
     "foo;  a=1",
     {{{Item("foo", Item::kTokenType), {Param("a", 1)}}}},
     "foo;a=1"},
    {"0x21 starting a parameterised list key", "foo; !a=1", base::nullopt},
    {"0x22 starting a parameterised list key", "foo; \"a=1", base::nullopt},
    {"0x23 starting a parameterised list key", "foo; #a=1", base::nullopt},
    {"0x24 starting a parameterised list key", "foo; $a=1", base::nullopt},
    {"0x25 starting a parameterised list key", "foo; %a=1", base::nullopt},
    {"0x26 starting a parameterised list key", "foo; &a=1", base::nullopt},
    {"0x27 starting a parameterised list key", "foo; 'a=1", base::nullopt},
    {"0x28 starting a parameterised list key", "foo; (a=1", base::nullopt},
    {"0x29 starting a parameterised list key", "foo; )a=1", base::nullopt},
    {"0x2b starting a parameterised list key", "foo; +a=1", base::nullopt},
    {"0x2a starting a parameterised list key",
     "foo; *a=1",
     {{{Item("foo", Item::kTokenType), {Param("*a", 1)}}}},
     "foo;*a=1"},
    {"0x2c starting a parameterised list key", "foo; ,a=1", base::nullopt},
    {"0x2d starting a parameterised list key", "foo; -a=1", base::nullopt},
    {"0x2e starting a parameterised list key", "foo; .a=1", base::nullopt},
    {"0x2f starting a parameterised list key", "foo; /a=1", base::nullopt},
    {"0x30 starting a parameterised list key", "foo; 0a=1", base::nullopt},
    {"0x31 starting a parameterised list key", "foo; 1a=1", base::nullopt},
    {"0x32 starting a parameterised list key", "foo; 2a=1", base::nullopt},
    {"0x33 starting a parameterised list key", "foo; 3a=1", base::nullopt},
    {"0x34 starting a parameterised list key", "foo; 4a=1", base::nullopt},
    {"0x35 starting a parameterised list key", "foo; 5a=1", base::nullopt},
    {"0x36 starting a parameterised list key", "foo; 6a=1", base::nullopt},
    {"0x37 starting a parameterised list key", "foo; 7a=1", base::nullopt},
    {"0x38 starting a parameterised list key", "foo; 8a=1", base::nullopt},
    {"0x39 starting a parameterised list key", "foo; 9a=1", base::nullopt},
    {"0x3a starting a parameterised list key", "foo; :a=1", base::nullopt},
    {"0x3b starting a parameterised list key", "foo; ;a=1", base::nullopt},
    {"0x3c starting a parameterised list key", "foo; <a=1", base::nullopt},
    {"0x3d starting a parameterised list key", "foo; =a=1", base::nullopt},
    {"0x3e starting a parameterised list key", "foo; >a=1", base::nullopt},
    {"0x3f starting a parameterised list key", "foo; ?a=1", base::nullopt},
    {"0x40 starting a parameterised list key", "foo; @a=1", base::nullopt},
    {"0x41 starting a parameterised list key", "foo; Aa=1", base::nullopt},
    {"0x42 starting a parameterised list key", "foo; Ba=1", base::nullopt},
    {"0x43 starting a parameterised list key", "foo; Ca=1", base::nullopt},
    {"0x44 starting a parameterised list key", "foo; Da=1", base::nullopt},
    {"0x45 starting a parameterised list key", "foo; Ea=1", base::nullopt},
    {"0x46 starting a parameterised list key", "foo; Fa=1", base::nullopt},
    {"0x47 starting a parameterised list key", "foo; Ga=1", base::nullopt},
    {"0x48 starting a parameterised list key", "foo; Ha=1", base::nullopt},
    {"0x49 starting a parameterised list key", "foo; Ia=1", base::nullopt},
    {"0x4a starting a parameterised list key", "foo; Ja=1", base::nullopt},
    {"0x4b starting a parameterised list key", "foo; Ka=1", base::nullopt},
    {"0x4c starting a parameterised list key", "foo; La=1", base::nullopt},
    {"0x4d starting a parameterised list key", "foo; Ma=1", base::nullopt},
    {"0x4e starting a parameterised list key", "foo; Na=1", base::nullopt},
    {"0x4f starting a parameterised list key", "foo; Oa=1", base::nullopt},
    {"0x50 starting a parameterised list key", "foo; Pa=1", base::nullopt},
    {"0x51 starting a parameterised list key", "foo; Qa=1", base::nullopt},
    {"0x52 starting a parameterised list key", "foo; Ra=1", base::nullopt},
    {"0x53 starting a parameterised list key", "foo; Sa=1", base::nullopt},
    {"0x54 starting a parameterised list key", "foo; Ta=1", base::nullopt},
    {"0x55 starting a parameterised list key", "foo; Ua=1", base::nullopt},
    {"0x56 starting a parameterised list key", "foo; Va=1", base::nullopt},
    {"0x57 starting a parameterised list key", "foo; Wa=1", base::nullopt},
    {"0x58 starting a parameterised list key", "foo; Xa=1", base::nullopt},
    {"0x59 starting a parameterised list key", "foo; Ya=1", base::nullopt},
    {"0x5a starting a parameterised list key", "foo; Za=1", base::nullopt},
    {"0x5b starting a parameterised list key", "foo; [a=1", base::nullopt},
    {"0x5c starting a parameterised list key", "foo; \\a=1", base::nullopt},
    {"0x5d starting a parameterised list key", "foo; ]a=1", base::nullopt},
    {"0x5e starting a parameterised list key", "foo; ^a=1", base::nullopt},
    {"0x5f starting a parameterised list key", "foo; _a=1", base::nullopt},
    {"0x60 starting a parameterised list key", "foo; `a=1", base::nullopt},
    {"0x61 starting a parameterised list key",
     "foo; aa=1",
     {{{Item("foo", Item::kTokenType), {Param("aa", 1)}}}},
     "foo;aa=1"},
    {"0x62 starting a parameterised list key",
     "foo; ba=1",
     {{{Item("foo", Item::kTokenType), {Param("ba", 1)}}}},
     "foo;ba=1"},
    {"0x63 starting a parameterised list key",
     "foo; ca=1",
     {{{Item("foo", Item::kTokenType), {Param("ca", 1)}}}},
     "foo;ca=1"},
    {"0x64 starting a parameterised list key",
     "foo; da=1",
     {{{Item("foo", Item::kTokenType), {Param("da", 1)}}}},
     "foo;da=1"},
    {"0x65 starting a parameterised list key",
     "foo; ea=1",
     {{{Item("foo", Item::kTokenType), {Param("ea", 1)}}}},
     "foo;ea=1"},
    {"0x66 starting a parameterised list key",
     "foo; fa=1",
     {{{Item("foo", Item::kTokenType), {Param("fa", 1)}}}},
     "foo;fa=1"},
    {"0x67 starting a parameterised list key",
     "foo; ga=1",
     {{{Item("foo", Item::kTokenType), {Param("ga", 1)}}}},
     "foo;ga=1"},
    {"0x68 starting a parameterised list key",
     "foo; ha=1",
     {{{Item("foo", Item::kTokenType), {Param("ha", 1)}}}},
     "foo;ha=1"},
    {"0x69 starting a parameterised list key",
     "foo; ia=1",
     {{{Item("foo", Item::kTokenType), {Param("ia", 1)}}}},
     "foo;ia=1"},
    {"0x6a starting a parameterised list key",
     "foo; ja=1",
     {{{Item("foo", Item::kTokenType), {Param("ja", 1)}}}},
     "foo;ja=1"},
    {"0x6b starting a parameterised list key",
     "foo; ka=1",
     {{{Item("foo", Item::kTokenType), {Param("ka", 1)}}}},
     "foo;ka=1"},
    {"0x6c starting a parameterised list key",
     "foo; la=1",
     {{{Item("foo", Item::kTokenType), {Param("la", 1)}}}},
     "foo;la=1"},
    {"0x6d starting a parameterised list key",
     "foo; ma=1",
     {{{Item("foo", Item::kTokenType), {Param("ma", 1)}}}},
     "foo;ma=1"},
    {"0x6e starting a parameterised list key",
     "foo; na=1",
     {{{Item("foo", Item::kTokenType), {Param("na", 1)}}}},
     "foo;na=1"},
    {"0x6f starting a parameterised list key",
     "foo; oa=1",
     {{{Item("foo", Item::kTokenType), {Param("oa", 1)}}}},
     "foo;oa=1"},
    {"0x70 starting a parameterised list key",
     "foo; pa=1",
     {{{Item("foo", Item::kTokenType), {Param("pa", 1)}}}},
     "foo;pa=1"},
    {"0x71 starting a parameterised list key",
     "foo; qa=1",
     {{{Item("foo", Item::kTokenType), {Param("qa", 1)}}}},
     "foo;qa=1"},
    {"0x72 starting a parameterised list key",
     "foo; ra=1",
     {{{Item("foo", Item::kTokenType), {Param("ra", 1)}}}},
     "foo;ra=1"},
    {"0x73 starting a parameterised list key",
     "foo; sa=1",
     {{{Item("foo", Item::kTokenType), {Param("sa", 1)}}}},
     "foo;sa=1"},
    {"0x74 starting a parameterised list key",
     "foo; ta=1",
     {{{Item("foo", Item::kTokenType), {Param("ta", 1)}}}},
     "foo;ta=1"},
    {"0x75 starting a parameterised list key",
     "foo; ua=1",
     {{{Item("foo", Item::kTokenType), {Param("ua", 1)}}}},
     "foo;ua=1"},
    {"0x76 starting a parameterised list key",
     "foo; va=1",
     {{{Item("foo", Item::kTokenType), {Param("va", 1)}}}},
     "foo;va=1"},
    {"0x77 starting a parameterised list key",
     "foo; wa=1",
     {{{Item("foo", Item::kTokenType), {Param("wa", 1)}}}},
     "foo;wa=1"},
    {"0x78 starting a parameterised list key",
     "foo; xa=1",
     {{{Item("foo", Item::kTokenType), {Param("xa", 1)}}}},
     "foo;xa=1"},
    {"0x79 starting a parameterised list key",
     "foo; ya=1",
     {{{Item("foo", Item::kTokenType), {Param("ya", 1)}}}},
     "foo;ya=1"},
    {"0x7a starting a parameterised list key",
     "foo; za=1",
     {{{Item("foo", Item::kTokenType), {Param("za", 1)}}}},
     "foo;za=1"},
    {"0x7b starting a parameterised list key", "foo; {a=1", base::nullopt},
    {"0x7c starting a parameterised list key", "foo; |a=1", base::nullopt},
    {"0x7d starting a parameterised list key", "foo; }a=1", base::nullopt},
    {"0x7e starting a parameterised list key", "foo; ~a=1", base::nullopt},
    {"0x7f starting a parameterised list key", "foo; \177a=1", base::nullopt},
    {"basic list", "1, 42", {{{Integer(1), {}}, {Integer(42), {}}}}},
    {"empty list", "", {List()}},
    {"leading SP list",
     "  42, 43",
     {{{Integer(42), {}}, {Integer(43), {}}}},
     "42, 43"},
    {"single item list", "42", {{{Integer(42), {}}}}},
    {"no whitespace list",
     "1,42",
     {{{Integer(1), {}}, {Integer(42), {}}}},
     "1, 42"},
    {"extra whitespace list",
     "1 , 42",
     {{{Integer(1), {}}, {Integer(42), {}}}},
     "1, 42"},
    {"tab separated list", "1\t,\t42", base::nullopt},
    {"two line list",
     "1, 42",
     {{{Integer(1), {}}, {Integer(42), {}}}},
     "1, 42"},
    {"trailing comma list", "1, 42,", base::nullopt},
    {"empty item list", "1,,42", base::nullopt},
    {"basic list of lists",
     "(1 2), (42 43)",
     {{{{{Integer(1), {}}, {Integer(2), {}}}, {}},
       {{{Integer(42), {}}, {Integer(43), {}}}, {}}}}},
    {"single item list of lists", "(42)", {{{{{Integer(42), {}}}, {}}}}},
    {"empty item list of lists",
     "()",
     {{{std::vector<ParameterizedItem>(), {}}}}},
    {"empty middle item list of lists",
     "(1),(),(42)",
     {{{{{Integer(1), {}}}, {}},
       {std::vector<ParameterizedItem>(), {}},
       {{{Integer(42), {}}}, {}}}},
     "(1), (), (42)"},
    {"extra whitespace list of lists",
     "(  1  42  )",
     {{{{{Integer(1), {}}, {Integer(42), {}}}, {}}}},
     "(1 42)"},
    {"wrong whitespace list of lists", "(1\t 42)", base::nullopt},
    {"no trailing parenthesis list of lists", "(1 42", base::nullopt},
    {"no trailing parenthesis middle list of lists", "(1 2, (42 43)",
     base::nullopt},
    {"no spaces in inner-list", "(abc\"def\"?0123*dXZ3*xyz)", base::nullopt},
    {"basic parameterised list",
     "abc_123;a=1;b=2; cdef_456, ghi;q=9;r=\"+w\"",
     {{{Item("abc_123", Item::kTokenType),
        {Param("a", 1), Param("b", 2), BooleanParam("cdef_456", true)}},
       {Item("ghi", Item::kTokenType), {Param("q", 9), Param("r", "+w")}}}},
     "abc_123;a=1;b=2;cdef_456, ghi;q=9;r=\"+w\""},
    {"single item parameterised list",
     "text/html;q=1.0",
     {{{Item("text/html", Item::kTokenType), {DoubleParam("q", 1.000000)}}}}},
    {"missing parameter value parameterised list",
     "text/html;a;q=1.0",
     {{{Item("text/html", Item::kTokenType),
        {BooleanParam("a", true), DoubleParam("q", 1.000000)}}}}},
    {"missing terminal parameter value parameterised list",
     "text/html;q=1.0;a",
     {{{Item("text/html", Item::kTokenType),
        {DoubleParam("q", 1.000000), BooleanParam("a", true)}}}}},
    {"no whitespace parameterised list",
     "text/html,text/plain;q=0.5",
     {{{Item("text/html", Item::kTokenType), {}},
       {Item("text/plain", Item::kTokenType), {DoubleParam("q", 0.500000)}}}},
     "text/html, text/plain;q=0.5"},
    {"whitespace before = parameterised list", "text/html, text/plain;q =0.5",
     base::nullopt},
    {"whitespace after = parameterised list", "text/html, text/plain;q= 0.5",
     base::nullopt},
    {"whitespace before ; parameterised list", "text/html, text/plain ;q=0.5",
     base::nullopt},
    {"whitespace after ; parameterised list",
     "text/html, text/plain; q=0.5",
     {{{Item("text/html", Item::kTokenType), {}},
       {Item("text/plain", Item::kTokenType), {DoubleParam("q", 0.500000)}}}},
     "text/html, text/plain;q=0.5"},
    {"extra whitespace parameterised list",
     "text/html  ,  text/plain;  q=0.5;  charset=utf-8",
     {{{Item("text/html", Item::kTokenType), {}},
       {Item("text/plain", Item::kTokenType),
        {DoubleParam("q", 0.500000), TokenParam("charset", "utf-8")}}}},
     "text/html, text/plain;q=0.5;charset=utf-8"},
    {"two lines parameterised list",
     "text/html, text/plain;q=0.5",
     {{{Item("text/html", Item::kTokenType), {}},
       {Item("text/plain", Item::kTokenType), {DoubleParam("q", 0.500000)}}}},
     "text/html, text/plain;q=0.5"},
    {"trailing comma parameterised list", "text/html,text/plain;q=0.5,",
     base::nullopt},
    {"empty item parameterised list", "text/html,,text/plain;q=0.5,",
     base::nullopt},
    {"basic token - list",
     "a_b-c3/*",
     {{{Item("a_b-c3/*", Item::kTokenType), {}}}}},
    {"token with capitals - list",
     "fooBar",
     {{{Item("fooBar", Item::kTokenType), {}}}}},
    {"token starting with capitals - list",
     "FooBar",
     {{{Item("FooBar", Item::kTokenType), {}}}}},
    {"0x01 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\001a", 1)}}}}},
    {"0x02 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\002a", 1)}}}}},
    {"0x03 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\003a", 1)}}}}},
    {"0x04 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\004a", 1)}}}}},
    {"0x05 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\005a", 1)}}}}},
    {"0x06 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\006a", 1)}}}}},
    {"0x07 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\aa", 1)}}}}},
    {"0x08 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\ba", 1)}}}}},
    {"0x09 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\ta", 1)}}}}},
    {"0x0a in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\na", 1)}}}}},
    {"0x0b in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\va", 1)}}}}},
    {"0x0c in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\fa", 1)}}}}},
    {"0x0d in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\ra", 1)}}}}},
    {"0x0e in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\016a", 1)}}}}},
    {"0x0f in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\017a", 1)}}}}},
    {"0x10 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\020a", 1)}}}}},
    {"0x11 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\021a", 1)}}}}},
    {"0x12 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\022a", 1)}}}}},
    {"0x13 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\023a", 1)}}}}},
    {"0x14 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\024a", 1)}}}}},
    {"0x15 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\025a", 1)}}}}},
    {"0x16 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\026a", 1)}}}}},
    {"0x17 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\027a", 1)}}}}},
    {"0x18 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\030a", 1)}}}}},
    {"0x19 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\031a", 1)}}}}},
    {"0x1a in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\032a", 1)}}}}},
    {"0x1b in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\033a", 1)}}}}},
    {"0x1c in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\034a", 1)}}}}},
    {"0x1d in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\035a", 1)}}}}},
    {"0x1e in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\036a", 1)}}}}},
    {"0x1f in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\037a", 1)}}}}},
    {"0x20 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a a", 1)}}}}},
    {"0x21 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a!a", 1)}}}}},
    {"0x22 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\"a", 1)}}}}},
    {"0x23 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a#a", 1)}}}}},
    {"0x24 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a$a", 1)}}}}},
    {"0x25 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a%a", 1)}}}}},
    {"0x26 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a&a", 1)}}}}},
    {"0x27 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a'a", 1)}}}}},
    {"0x28 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a(a", 1)}}}}},
    {"0x29 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a)a", 1)}}}}},
    {"0x2b in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a+a", 1)}}}}},
    {"0x2c in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a,a", 1)}}}}},
    {"0x2f in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a/a", 1)}}}}},
    {"0x3a in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a:a", 1)}}}}},
    {"0x3b in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a;a", 1)}}}}},
    {"0x3c in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a<a", 1)}}}}},
    {"0x3d in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a=a", 1)}}}}},
    {"0x3e in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a>a", 1)}}}}},
    {"0x3f in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a?a", 1)}}}}},
    {"0x40 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a@a", 1)}}}}},
    {"0x41 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aAa", 1)}}}}},
    {"0x42 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aBa", 1)}}}}},
    {"0x43 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aCa", 1)}}}}},
    {"0x44 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aDa", 1)}}}}},
    {"0x45 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aEa", 1)}}}}},
    {"0x46 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aFa", 1)}}}}},
    {"0x47 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aGa", 1)}}}}},
    {"0x48 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aHa", 1)}}}}},
    {"0x49 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aIa", 1)}}}}},
    {"0x4a in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aJa", 1)}}}}},
    {"0x4b in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aKa", 1)}}}}},
    {"0x4c in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aLa", 1)}}}}},
    {"0x4d in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aMa", 1)}}}}},
    {"0x4e in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aNa", 1)}}}}},
    {"0x4f in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aOa", 1)}}}}},
    {"0x50 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aPa", 1)}}}}},
    {"0x51 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aQa", 1)}}}}},
    {"0x52 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aRa", 1)}}}}},
    {"0x53 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aSa", 1)}}}}},
    {"0x54 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aTa", 1)}}}}},
    {"0x55 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aUa", 1)}}}}},
    {"0x56 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aVa", 1)}}}}},
    {"0x57 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aWa", 1)}}}}},
    {"0x58 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aXa", 1)}}}}},
    {"0x59 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aYa", 1)}}}}},
    {"0x5a in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("aZa", 1)}}}}},
    {"0x5b in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a[a", 1)}}}}},
    {"0x5c in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\\a", 1)}}}}},
    {"0x5d in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a]a", 1)}}}}},
    {"0x5e in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a^a", 1)}}}}},
    {"0x60 in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a`a", 1)}}}}},
    {"0x7b in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a{a", 1)}}}}},
    {"0x7c in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a|a", 1)}}}}},
    {"0x7d in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a}a", 1)}}}}},
    {"0x7e in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a~a", 1)}}}}},
    {"0x7f in parameterised list key - serialise only",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("a\177a", 1)}}}}},
    {"0x01 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\001a", 1)}}}}},
    {"0x02 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\002a", 1)}}}}},
    {"0x03 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\003a", 1)}}}}},
    {"0x04 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\004a", 1)}}}}},
    {"0x05 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\005a", 1)}}}}},
    {"0x06 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\006a", 1)}}}}},
    {"0x07 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\aa", 1)}}}}},
    {"0x08 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\ba", 1)}}}}},
    {"0x09 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\ta", 1)}}}}},
    {"0x0a starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\na", 1)}}}}},
    {"0x0b starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\va", 1)}}}}},
    {"0x0c starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\fa", 1)}}}}},
    {"0x0d starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\ra", 1)}}}}},
    {"0x0e starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\016a", 1)}}}}},
    {"0x0f starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\017a", 1)}}}}},
    {"0x10 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\020a", 1)}}}}},
    {"0x11 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\021a", 1)}}}}},
    {"0x12 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\022a", 1)}}}}},
    {"0x13 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\023a", 1)}}}}},
    {"0x14 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\024a", 1)}}}}},
    {"0x15 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\025a", 1)}}}}},
    {"0x16 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\026a", 1)}}}}},
    {"0x17 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\027a", 1)}}}}},
    {"0x18 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\030a", 1)}}}}},
    {"0x19 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\031a", 1)}}}}},
    {"0x1a starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\032a", 1)}}}}},
    {"0x1b starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\033a", 1)}}}}},
    {"0x1c starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\034a", 1)}}}}},
    {"0x1d starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\035a", 1)}}}}},
    {"0x1e starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\036a", 1)}}}}},
    {"0x1f starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\037a", 1)}}}}},
    {"0x20 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param(" a", 1)}}}}},
    {"0x21 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("!a", 1)}}}}},
    {"0x22 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\"a", 1)}}}}},
    {"0x23 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("#a", 1)}}}}},
    {"0x24 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("$a", 1)}}}}},
    {"0x25 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("%a", 1)}}}}},
    {"0x26 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("&a", 1)}}}}},
    {"0x27 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("'a", 1)}}}}},
    {"0x28 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("(a", 1)}}}}},
    {"0x29 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param(")a", 1)}}}}},
    {"0x2b starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("+a", 1)}}}}},
    {"0x2c starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param(",a", 1)}}}}},
    {"0x2d starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("-a", 1)}}}}},
    {"0x2e starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param(".a", 1)}}}}},
    {"0x2f starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("/a", 1)}}}}},
    {"0x30 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("0a", 1)}}}}},
    {"0x31 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("1a", 1)}}}}},
    {"0x32 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("2a", 1)}}}}},
    {"0x33 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("3a", 1)}}}}},
    {"0x34 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("4a", 1)}}}}},
    {"0x35 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("5a", 1)}}}}},
    {"0x36 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("6a", 1)}}}}},
    {"0x37 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("7a", 1)}}}}},
    {"0x38 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("8a", 1)}}}}},
    {"0x39 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("9a", 1)}}}}},
    {"0x3a starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param(":a", 1)}}}}},
    {"0x3b starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param(";a", 1)}}}}},
    {"0x3c starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("<a", 1)}}}}},
    {"0x3d starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("=a", 1)}}}}},
    {"0x3e starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param(">a", 1)}}}}},
    {"0x3f starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("?a", 1)}}}}},
    {"0x40 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("@a", 1)}}}}},
    {"0x41 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Aa", 1)}}}}},
    {"0x42 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Ba", 1)}}}}},
    {"0x43 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Ca", 1)}}}}},
    {"0x44 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Da", 1)}}}}},
    {"0x45 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Ea", 1)}}}}},
    {"0x46 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Fa", 1)}}}}},
    {"0x47 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Ga", 1)}}}}},
    {"0x48 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Ha", 1)}}}}},
    {"0x49 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Ia", 1)}}}}},
    {"0x4a starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Ja", 1)}}}}},
    {"0x4b starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Ka", 1)}}}}},
    {"0x4c starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("La", 1)}}}}},
    {"0x4d starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Ma", 1)}}}}},
    {"0x4e starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Na", 1)}}}}},
    {"0x4f starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Oa", 1)}}}}},
    {"0x50 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Pa", 1)}}}}},
    {"0x51 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Qa", 1)}}}}},
    {"0x52 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Ra", 1)}}}}},
    {"0x53 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Sa", 1)}}}}},
    {"0x54 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Ta", 1)}}}}},
    {"0x55 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Ua", 1)}}}}},
    {"0x56 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Va", 1)}}}}},
    {"0x57 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Wa", 1)}}}}},
    {"0x58 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Xa", 1)}}}}},
    {"0x59 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Ya", 1)}}}}},
    {"0x5a starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("Za", 1)}}}}},
    {"0x5b starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("[a", 1)}}}}},
    {"0x5c starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\\a", 1)}}}}},
    {"0x5d starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("]a", 1)}}}}},
    {"0x5e starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("^a", 1)}}}}},
    {"0x5f starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("_a", 1)}}}}},
    {"0x60 starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("`a", 1)}}}}},
    {"0x7b starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("{a", 1)}}}}},
    {"0x7c starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("|a", 1)}}}}},
    {"0x7d starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("}a", 1)}}}}},
    {"0x7e starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("~a", 1)}}}}},
    {"0x7f starting a parameterised list key",
     nullptr,
     {{{Item("foo", Item::kTokenType), {Param("\177a", 1)}}}}},
};

const struct DictionaryTestCase {
  const char* name;
  const char* raw;
  const base::Optional<Dictionary>
      expected;           // nullopt if parse error is expected.
  const char* canonical;  // nullptr if parse error is expected, or if canonical
                          // format is identical to raw.
} dictionary_test_cases[] = {
    {"basic dictionary",
     "en=\"Applepie\", da=:w4ZibGV0w6ZydGUK:",
     {Dictionary{{{"en", {Item("Applepie"), {}}},
                  {"da",
                   {Item("\303\206blet\303\246rte\n", Item::kByteSequenceType),
                    {}}}}}}},
    {"empty dictionary", "", {Dictionary{{}}}},
    {"single item dictionary", "a=1", {Dictionary{{{"a", {Integer(1), {}}}}}}},
    {"list item dictionary",
     "a=(1 2)",
     {Dictionary{{{"a", {{{Integer(1), {}}, {Integer(2), {}}}, {}}}}}}},
    {"single list item dictionary",
     "a=(1)",
     {Dictionary{{{"a", {{{Integer(1), {}}}, {}}}}}}},
    {"empty list item dictionary",
     "a=()",
     {Dictionary{{{"a", {std::vector<ParameterizedItem>(), {}}}}}}},
    {"no whitespace dictionary",
     "a=1,b=2",
     {Dictionary{{{"a", {Integer(1), {}}}, {"b", {Integer(2), {}}}}}},
     "a=1, b=2"},
    {"extra whitespace dictionary",
     "a=1 ,  b=2",
     {Dictionary{{{"a", {Integer(1), {}}}, {"b", {Integer(2), {}}}}}},
     "a=1, b=2"},
    {"leading whitespace dictionary",
     "     a=1 ,  b=2",
     {Dictionary{{{"a", {Integer(1), {}}}, {"b", {Integer(2), {}}}}}},
     "a=1, b=2"},
    {"whitespace before = dictionary", "a =1, b=2", base::nullopt},
    {"whitespace after = dictionary", "a=1, b= 2", base::nullopt},
    {"two lines dictionary",
     "a=1, b=2",
     {Dictionary{{{"a", {Integer(1), {}}}, {"b", {Integer(2), {}}}}}},
     "a=1, b=2"},
    {"missing value dictionary",
     "a=1, b, c=3",
     {Dictionary{{{"a", {Integer(1), {}}},
                  {"b", {Item(true), {}}},
                  {"c", {Integer(3), {}}}}}}},
    {"all missing value dictionary",
     "a, b, c",
     {Dictionary{{{"a", {Item(true), {}}},
                  {"b", {Item(true), {}}},
                  {"c", {Item(true), {}}}}}}},
    {"start missing value dictionary",
     "a, b=2",
     {Dictionary{{{"a", {Item(true), {}}}, {"b", {Integer(2), {}}}}}}},
    {"end missing value dictionary",
     "a=1, b",
     {Dictionary{{{"a", {Integer(1), {}}}, {"b", {Item(true), {}}}}}}},
    {"missing value with params dictionary",
     "a=1, b;foo=9, c=3",
     {Dictionary{{{"a", {Integer(1), {}}},
                  {"b", {Item(true), {Param("foo", 9)}}},
                  {"c", {Integer(3), {}}}}}}},
    {"explicit true value with params dictionary",
     "a=1, b=?1;foo=9, c=3",
     {Dictionary{{{"a", {Integer(1), {}}},
                  {"b", {Item(true), {Param("foo", 9)}}},
                  {"c", {Integer(3), {}}}}}},
     "a=1, b;foo=9, c=3"},
    {"trailing comma dictionary", "a=1, b=2,", base::nullopt},
    {"empty item dictionary", "a=1,,b=2,", base::nullopt},
    {"duplicate key dictionary",
     "a=1,b=2,a=3",
     {Dictionary{{{"a", {Integer(3), {}}}, {"b", {Integer(2), {}}}}}},
     "a=3, b=2"},
    {"numeric key dictionary", "a=1,1b=2,a=1", base::nullopt},
    {"uppercase key dictionary", "a=1,B=2,a=1", base::nullopt},
    {"bad key dictionary", "a=1,b!=2,a=1", base::nullopt},
    {"Example-DictHeader",
     "en=\"Applepie\", da=:w4ZibGV0w6ZydGU=:",
     {Dictionary{
         {{"en", {Item("Applepie"), {}}},
          {"da",
           {Item("\303\206blet\303\246rte", Item::kByteSequenceType), {}}}}}}},
    {"Example-DictHeader",
     "a=?0, b, c; foo=bar",
     {Dictionary{{{"a", {Item(false), {}}},
                  {"b", {Item(true), {}}},
                  {"c", {Item(true), {TokenParam("foo", "bar")}}}}}},
     "a=?0, b, c;foo=bar"},
    {"Example-DictListHeader",
     "rating=1.5, feelings=(joy sadness)",
     {Dictionary{{{"rating", {Item(1.500000), {}}},
                  {"feelings",
                   {{{Item("joy", Item::kTokenType), {}},
                     {Item("sadness", Item::kTokenType), {}}},
                    {}}}}}}},
    {"Example-MixDict",
     "a=(1 2), b=3, c=4;aa=bb, d=(5 6);valid",
     {Dictionary{{{"a", {{{Integer(1), {}}, {Integer(2), {}}}, {}}},
                  {"b", {Integer(3), {}}},
                  {"c", {Integer(4), {TokenParam("aa", "bb")}}},
                  {"d",
                   {{{Integer(5), {}}, {Integer(6), {}}},
                    {BooleanParam("valid", true)}}}}}},
     "a=(1 2), b=3, c=4;aa=bb, d=(5 6);valid"},
    {"Example-Hdr (dictionary on one line)",
     "foo=1, bar=2",
     {Dictionary{{{"foo", {Integer(1), {}}}, {"bar", {Integer(2), {}}}}}}},
    {"Example-Hdr (dictionary on two lines)",
     "foo=1, bar=2",
     {Dictionary{{{"foo", {Integer(1), {}}}, {"bar", {Integer(2), {}}}}}},
     "foo=1, bar=2"},
    {"0x01 in dictionary key", "a\001a=1", base::nullopt},
    {"0x02 in dictionary key", "a\002a=1", base::nullopt},
    {"0x03 in dictionary key", "a\003a=1", base::nullopt},
    {"0x04 in dictionary key", "a\004a=1", base::nullopt},
    {"0x05 in dictionary key", "a\005a=1", base::nullopt},
    {"0x06 in dictionary key", "a\006a=1", base::nullopt},
    {"0x07 in dictionary key", "a\aa=1", base::nullopt},
    {"0x08 in dictionary key", "a\ba=1", base::nullopt},
    {"0x09 in dictionary key", "a\ta=1", base::nullopt},
    {"0x0a in dictionary key", "a\na=1", base::nullopt},
    {"0x0b in dictionary key", "a\va=1", base::nullopt},
    {"0x0c in dictionary key", "a\fa=1", base::nullopt},
    {"0x0d in dictionary key", "a\ra=1", base::nullopt},
    {"0x0e in dictionary key", "a\016a=1", base::nullopt},
    {"0x0f in dictionary key", "a\017a=1", base::nullopt},
    {"0x10 in dictionary key", "a\020a=1", base::nullopt},
    {"0x11 in dictionary key", "a\021a=1", base::nullopt},
    {"0x12 in dictionary key", "a\022a=1", base::nullopt},
    {"0x13 in dictionary key", "a\023a=1", base::nullopt},
    {"0x14 in dictionary key", "a\024a=1", base::nullopt},
    {"0x15 in dictionary key", "a\025a=1", base::nullopt},
    {"0x16 in dictionary key", "a\026a=1", base::nullopt},
    {"0x17 in dictionary key", "a\027a=1", base::nullopt},
    {"0x18 in dictionary key", "a\030a=1", base::nullopt},
    {"0x19 in dictionary key", "a\031a=1", base::nullopt},
    {"0x1a in dictionary key", "a\032a=1", base::nullopt},
    {"0x1b in dictionary key", "a\033a=1", base::nullopt},
    {"0x1c in dictionary key", "a\034a=1", base::nullopt},
    {"0x1d in dictionary key", "a\035a=1", base::nullopt},
    {"0x1e in dictionary key", "a\036a=1", base::nullopt},
    {"0x1f in dictionary key", "a\037a=1", base::nullopt},
    {"0x20 in dictionary key", "a a=1", base::nullopt},
    {"0x21 in dictionary key", "a!a=1", base::nullopt},
    {"0x22 in dictionary key", "a\"a=1", base::nullopt},
    {"0x23 in dictionary key", "a#a=1", base::nullopt},
    {"0x24 in dictionary key", "a$a=1", base::nullopt},
    {"0x25 in dictionary key", "a%a=1", base::nullopt},
    {"0x26 in dictionary key", "a&a=1", base::nullopt},
    {"0x27 in dictionary key", "a'a=1", base::nullopt},
    {"0x28 in dictionary key", "a(a=1", base::nullopt},
    {"0x29 in dictionary key", "a)a=1", base::nullopt},
    {"0x2a in dictionary key",
     "a*a=1",
     {Dictionary{{{"a*a", {Integer(1), {}}}}}}},
    {"0x2b in dictionary key", "a+a=1", base::nullopt},
    {"0x2c in dictionary key",
     "a,a=1",
     {Dictionary{{{"a", {Integer(1), {}}}}}},
     "a=1"},
    {"0x2d in dictionary key",
     "a-a=1",
     {Dictionary{{{"a-a", {Integer(1), {}}}}}}},
    {"0x2e in dictionary key",
     "a.a=1",
     {Dictionary{{{"a.a", {Integer(1), {}}}}}}},
    {"0x2f in dictionary key", "a/a=1", base::nullopt},
    {"0x30 in dictionary key",
     "a0a=1",
     {Dictionary{{{"a0a", {Integer(1), {}}}}}}},
    {"0x31 in dictionary key",
     "a1a=1",
     {Dictionary{{{"a1a", {Integer(1), {}}}}}}},
    {"0x32 in dictionary key",
     "a2a=1",
     {Dictionary{{{"a2a", {Integer(1), {}}}}}}},
    {"0x33 in dictionary key",
     "a3a=1",
     {Dictionary{{{"a3a", {Integer(1), {}}}}}}},
    {"0x34 in dictionary key",
     "a4a=1",
     {Dictionary{{{"a4a", {Integer(1), {}}}}}}},
    {"0x35 in dictionary key",
     "a5a=1",
     {Dictionary{{{"a5a", {Integer(1), {}}}}}}},
    {"0x36 in dictionary key",
     "a6a=1",
     {Dictionary{{{"a6a", {Integer(1), {}}}}}}},
    {"0x37 in dictionary key",
     "a7a=1",
     {Dictionary{{{"a7a", {Integer(1), {}}}}}}},
    {"0x38 in dictionary key",
     "a8a=1",
     {Dictionary{{{"a8a", {Integer(1), {}}}}}}},
    {"0x39 in dictionary key",
     "a9a=1",
     {Dictionary{{{"a9a", {Integer(1), {}}}}}}},
    {"0x3a in dictionary key", "a:a=1", base::nullopt},
    {"0x3b in dictionary key",
     "a;a=1",
     {Dictionary{{{"a", {Item(true), {Param("a", 1)}}}}}}},
    {"0x3c in dictionary key", "a<a=1", base::nullopt},
    {"0x3d in dictionary key", "a=a=1", base::nullopt},
    {"0x3e in dictionary key", "a>a=1", base::nullopt},
    {"0x3f in dictionary key", "a?a=1", base::nullopt},
    {"0x40 in dictionary key", "a@a=1", base::nullopt},
    {"0x41 in dictionary key", "aAa=1", base::nullopt},
    {"0x42 in dictionary key", "aBa=1", base::nullopt},
    {"0x43 in dictionary key", "aCa=1", base::nullopt},
    {"0x44 in dictionary key", "aDa=1", base::nullopt},
    {"0x45 in dictionary key", "aEa=1", base::nullopt},
    {"0x46 in dictionary key", "aFa=1", base::nullopt},
    {"0x47 in dictionary key", "aGa=1", base::nullopt},
    {"0x48 in dictionary key", "aHa=1", base::nullopt},
    {"0x49 in dictionary key", "aIa=1", base::nullopt},
    {"0x4a in dictionary key", "aJa=1", base::nullopt},
    {"0x4b in dictionary key", "aKa=1", base::nullopt},
    {"0x4c in dictionary key", "aLa=1", base::nullopt},
    {"0x4d in dictionary key", "aMa=1", base::nullopt},
    {"0x4e in dictionary key", "aNa=1", base::nullopt},
    {"0x4f in dictionary key", "aOa=1", base::nullopt},
    {"0x50 in dictionary key", "aPa=1", base::nullopt},
    {"0x51 in dictionary key", "aQa=1", base::nullopt},
    {"0x52 in dictionary key", "aRa=1", base::nullopt},
    {"0x53 in dictionary key", "aSa=1", base::nullopt},
    {"0x54 in dictionary key", "aTa=1", base::nullopt},
    {"0x55 in dictionary key", "aUa=1", base::nullopt},
    {"0x56 in dictionary key", "aVa=1", base::nullopt},
    {"0x57 in dictionary key", "aWa=1", base::nullopt},
    {"0x58 in dictionary key", "aXa=1", base::nullopt},
    {"0x59 in dictionary key", "aYa=1", base::nullopt},
    {"0x5a in dictionary key", "aZa=1", base::nullopt},
    {"0x5b in dictionary key", "a[a=1", base::nullopt},
    {"0x5c in dictionary key", "a\\a=1", base::nullopt},
    {"0x5d in dictionary key", "a]a=1", base::nullopt},
    {"0x5e in dictionary key", "a^a=1", base::nullopt},
    {"0x5f in dictionary key",
     "a_a=1",
     {Dictionary{{{"a_a", {Integer(1), {}}}}}}},
    {"0x60 in dictionary key", "a`a=1", base::nullopt},
    {"0x61 in dictionary key",
     "aaa=1",
     {Dictionary{{{"aaa", {Integer(1), {}}}}}}},
    {"0x62 in dictionary key",
     "aba=1",
     {Dictionary{{{"aba", {Integer(1), {}}}}}}},
    {"0x63 in dictionary key",
     "aca=1",
     {Dictionary{{{"aca", {Integer(1), {}}}}}}},
    {"0x64 in dictionary key",
     "ada=1",
     {Dictionary{{{"ada", {Integer(1), {}}}}}}},
    {"0x65 in dictionary key",
     "aea=1",
     {Dictionary{{{"aea", {Integer(1), {}}}}}}},
    {"0x66 in dictionary key",
     "afa=1",
     {Dictionary{{{"afa", {Integer(1), {}}}}}}},
    {"0x67 in dictionary key",
     "aga=1",
     {Dictionary{{{"aga", {Integer(1), {}}}}}}},
    {"0x68 in dictionary key",
     "aha=1",
     {Dictionary{{{"aha", {Integer(1), {}}}}}}},
    {"0x69 in dictionary key",
     "aia=1",
     {Dictionary{{{"aia", {Integer(1), {}}}}}}},
    {"0x6a in dictionary key",
     "aja=1",
     {Dictionary{{{"aja", {Integer(1), {}}}}}}},
    {"0x6b in dictionary key",
     "aka=1",
     {Dictionary{{{"aka", {Integer(1), {}}}}}}},
    {"0x6c in dictionary key",
     "ala=1",
     {Dictionary{{{"ala", {Integer(1), {}}}}}}},
    {"0x6d in dictionary key",
     "ama=1",
     {Dictionary{{{"ama", {Integer(1), {}}}}}}},
    {"0x6e in dictionary key",
     "ana=1",
     {Dictionary{{{"ana", {Integer(1), {}}}}}}},
    {"0x6f in dictionary key",
     "aoa=1",
     {Dictionary{{{"aoa", {Integer(1), {}}}}}}},
    {"0x70 in dictionary key",
     "apa=1",
     {Dictionary{{{"apa", {Integer(1), {}}}}}}},
    {"0x71 in dictionary key",
     "aqa=1",
     {Dictionary{{{"aqa", {Integer(1), {}}}}}}},
    {"0x72 in dictionary key",
     "ara=1",
     {Dictionary{{{"ara", {Integer(1), {}}}}}}},
    {"0x73 in dictionary key",
     "asa=1",
     {Dictionary{{{"asa", {Integer(1), {}}}}}}},
    {"0x74 in dictionary key",
     "ata=1",
     {Dictionary{{{"ata", {Integer(1), {}}}}}}},
    {"0x75 in dictionary key",
     "aua=1",
     {Dictionary{{{"aua", {Integer(1), {}}}}}}},
    {"0x76 in dictionary key",
     "ava=1",
     {Dictionary{{{"ava", {Integer(1), {}}}}}}},
    {"0x77 in dictionary key",
     "awa=1",
     {Dictionary{{{"awa", {Integer(1), {}}}}}}},
    {"0x78 in dictionary key",
     "axa=1",
     {Dictionary{{{"axa", {Integer(1), {}}}}}}},
    {"0x79 in dictionary key",
     "aya=1",
     {Dictionary{{{"aya", {Integer(1), {}}}}}}},
    {"0x7a in dictionary key",
     "aza=1",
     {Dictionary{{{"aza", {Integer(1), {}}}}}}},
    {"0x7b in dictionary key", "a{a=1", base::nullopt},
    {"0x7c in dictionary key", "a|a=1", base::nullopt},
    {"0x7d in dictionary key", "a}a=1", base::nullopt},
    {"0x7e in dictionary key", "a~a=1", base::nullopt},
    {"0x7f in dictionary key", "a\177a=1", base::nullopt},
    {"0x01 starting an dictionary key", "\001a=1", base::nullopt},
    {"0x02 starting an dictionary key", "\002a=1", base::nullopt},
    {"0x03 starting an dictionary key", "\003a=1", base::nullopt},
    {"0x04 starting an dictionary key", "\004a=1", base::nullopt},
    {"0x05 starting an dictionary key", "\005a=1", base::nullopt},
    {"0x06 starting an dictionary key", "\006a=1", base::nullopt},
    {"0x07 starting an dictionary key", "\aa=1", base::nullopt},
    {"0x08 starting an dictionary key", "\ba=1", base::nullopt},
    {"0x09 starting an dictionary key", "\ta=1", base::nullopt},
    {"0x0a starting an dictionary key", "\na=1", base::nullopt},
    {"0x0b starting an dictionary key", "\va=1", base::nullopt},
    {"0x0c starting an dictionary key", "\fa=1", base::nullopt},
    {"0x0d starting an dictionary key", "\ra=1", base::nullopt},
    {"0x0e starting an dictionary key", "\016a=1", base::nullopt},
    {"0x0f starting an dictionary key", "\017a=1", base::nullopt},
    {"0x10 starting an dictionary key", "\020a=1", base::nullopt},
    {"0x11 starting an dictionary key", "\021a=1", base::nullopt},
    {"0x12 starting an dictionary key", "\022a=1", base::nullopt},
    {"0x13 starting an dictionary key", "\023a=1", base::nullopt},
    {"0x14 starting an dictionary key", "\024a=1", base::nullopt},
    {"0x15 starting an dictionary key", "\025a=1", base::nullopt},
    {"0x16 starting an dictionary key", "\026a=1", base::nullopt},
    {"0x17 starting an dictionary key", "\027a=1", base::nullopt},
    {"0x18 starting an dictionary key", "\030a=1", base::nullopt},
    {"0x19 starting an dictionary key", "\031a=1", base::nullopt},
    {"0x1a starting an dictionary key", "\032a=1", base::nullopt},
    {"0x1b starting an dictionary key", "\033a=1", base::nullopt},
    {"0x1c starting an dictionary key", "\034a=1", base::nullopt},
    {"0x1d starting an dictionary key", "\035a=1", base::nullopt},
    {"0x1e starting an dictionary key", "\036a=1", base::nullopt},
    {"0x1f starting an dictionary key", "\037a=1", base::nullopt},
    {"0x20 starting an dictionary key",
     " a=1",
     {Dictionary{{{"a", {Integer(1), {}}}}}},
     "a=1"},
    {"0x21 starting an dictionary key", "!a=1", base::nullopt},
    {"0x22 starting an dictionary key", "\"a=1", base::nullopt},
    {"0x23 starting an dictionary key", "#a=1", base::nullopt},
    {"0x24 starting an dictionary key", "$a=1", base::nullopt},
    {"0x25 starting an dictionary key", "%a=1", base::nullopt},
    {"0x26 starting an dictionary key", "&a=1", base::nullopt},
    {"0x27 starting an dictionary key", "'a=1", base::nullopt},
    {"0x28 starting an dictionary key", "(a=1", base::nullopt},
    {"0x29 starting an dictionary key", ")a=1", base::nullopt},
    {"0x2a starting an dictionary key",
     "*a=1",
     {Dictionary{{{"*a", {Integer(1), {}}}}}}},
    {"0x2b starting an dictionary key", "+a=1", base::nullopt},
    {"0x2c starting an dictionary key", ",a=1", base::nullopt},
    {"0x2d starting an dictionary key", "-a=1", base::nullopt},
    {"0x2e starting an dictionary key", ".a=1", base::nullopt},
    {"0x2f starting an dictionary key", "/a=1", base::nullopt},
    {"0x30 starting an dictionary key", "0a=1", base::nullopt},
    {"0x31 starting an dictionary key", "1a=1", base::nullopt},
    {"0x32 starting an dictionary key", "2a=1", base::nullopt},
    {"0x33 starting an dictionary key", "3a=1", base::nullopt},
    {"0x34 starting an dictionary key", "4a=1", base::nullopt},
    {"0x35 starting an dictionary key", "5a=1", base::nullopt},
    {"0x36 starting an dictionary key", "6a=1", base::nullopt},
    {"0x37 starting an dictionary key", "7a=1", base::nullopt},
    {"0x38 starting an dictionary key", "8a=1", base::nullopt},
    {"0x39 starting an dictionary key", "9a=1", base::nullopt},
    {"0x3a starting an dictionary key", ":a=1", base::nullopt},
    {"0x3b starting an dictionary key", ";a=1", base::nullopt},
    {"0x3c starting an dictionary key", "<a=1", base::nullopt},
    {"0x3d starting an dictionary key", "=a=1", base::nullopt},
    {"0x3e starting an dictionary key", ">a=1", base::nullopt},
    {"0x3f starting an dictionary key", "?a=1", base::nullopt},
    {"0x40 starting an dictionary key", "@a=1", base::nullopt},
    {"0x41 starting an dictionary key", "Aa=1", base::nullopt},
    {"0x42 starting an dictionary key", "Ba=1", base::nullopt},
    {"0x43 starting an dictionary key", "Ca=1", base::nullopt},
    {"0x44 starting an dictionary key", "Da=1", base::nullopt},
    {"0x45 starting an dictionary key", "Ea=1", base::nullopt},
    {"0x46 starting an dictionary key", "Fa=1", base::nullopt},
    {"0x47 starting an dictionary key", "Ga=1", base::nullopt},
    {"0x48 starting an dictionary key", "Ha=1", base::nullopt},
    {"0x49 starting an dictionary key", "Ia=1", base::nullopt},
    {"0x4a starting an dictionary key", "Ja=1", base::nullopt},
    {"0x4b starting an dictionary key", "Ka=1", base::nullopt},
    {"0x4c starting an dictionary key", "La=1", base::nullopt},
    {"0x4d starting an dictionary key", "Ma=1", base::nullopt},
    {"0x4e starting an dictionary key", "Na=1", base::nullopt},
    {"0x4f starting an dictionary key", "Oa=1", base::nullopt},
    {"0x50 starting an dictionary key", "Pa=1", base::nullopt},
    {"0x51 starting an dictionary key", "Qa=1", base::nullopt},
    {"0x52 starting an dictionary key", "Ra=1", base::nullopt},
    {"0x53 starting an dictionary key", "Sa=1", base::nullopt},
    {"0x54 starting an dictionary key", "Ta=1", base::nullopt},
    {"0x55 starting an dictionary key", "Ua=1", base::nullopt},
    {"0x56 starting an dictionary key", "Va=1", base::nullopt},
    {"0x57 starting an dictionary key", "Wa=1", base::nullopt},
    {"0x58 starting an dictionary key", "Xa=1", base::nullopt},
    {"0x59 starting an dictionary key", "Ya=1", base::nullopt},
    {"0x5a starting an dictionary key", "Za=1", base::nullopt},
    {"0x5b starting an dictionary key", "[a=1", base::nullopt},
    {"0x5c starting an dictionary key", "\\a=1", base::nullopt},
    {"0x5d starting an dictionary key", "]a=1", base::nullopt},
    {"0x5e starting an dictionary key", "^a=1", base::nullopt},
    {"0x5f starting an dictionary key", "_a=1", base::nullopt},
    {"0x60 starting an dictionary key", "`a=1", base::nullopt},
    {"0x61 starting an dictionary key",
     "aa=1",
     {Dictionary{{{"aa", {Integer(1), {}}}}}}},
    {"0x62 starting an dictionary key",
     "ba=1",
     {Dictionary{{{"ba", {Integer(1), {}}}}}}},
    {"0x63 starting an dictionary key",
     "ca=1",
     {Dictionary{{{"ca", {Integer(1), {}}}}}}},
    {"0x64 starting an dictionary key",
     "da=1",
     {Dictionary{{{"da", {Integer(1), {}}}}}}},
    {"0x65 starting an dictionary key",
     "ea=1",
     {Dictionary{{{"ea", {Integer(1), {}}}}}}},
    {"0x66 starting an dictionary key",
     "fa=1",
     {Dictionary{{{"fa", {Integer(1), {}}}}}}},
    {"0x67 starting an dictionary key",
     "ga=1",
     {Dictionary{{{"ga", {Integer(1), {}}}}}}},
    {"0x68 starting an dictionary key",
     "ha=1",
     {Dictionary{{{"ha", {Integer(1), {}}}}}}},
    {"0x69 starting an dictionary key",
     "ia=1",
     {Dictionary{{{"ia", {Integer(1), {}}}}}}},
    {"0x6a starting an dictionary key",
     "ja=1",
     {Dictionary{{{"ja", {Integer(1), {}}}}}}},
    {"0x6b starting an dictionary key",
     "ka=1",
     {Dictionary{{{"ka", {Integer(1), {}}}}}}},
    {"0x6c starting an dictionary key",
     "la=1",
     {Dictionary{{{"la", {Integer(1), {}}}}}}},
    {"0x6d starting an dictionary key",
     "ma=1",
     {Dictionary{{{"ma", {Integer(1), {}}}}}}},
    {"0x6e starting an dictionary key",
     "na=1",
     {Dictionary{{{"na", {Integer(1), {}}}}}}},
    {"0x6f starting an dictionary key",
     "oa=1",
     {Dictionary{{{"oa", {Integer(1), {}}}}}}},
    {"0x70 starting an dictionary key",
     "pa=1",
     {Dictionary{{{"pa", {Integer(1), {}}}}}}},
    {"0x71 starting an dictionary key",
     "qa=1",
     {Dictionary{{{"qa", {Integer(1), {}}}}}}},
    {"0x72 starting an dictionary key",
     "ra=1",
     {Dictionary{{{"ra", {Integer(1), {}}}}}}},
    {"0x73 starting an dictionary key",
     "sa=1",
     {Dictionary{{{"sa", {Integer(1), {}}}}}}},
    {"0x74 starting an dictionary key",
     "ta=1",
     {Dictionary{{{"ta", {Integer(1), {}}}}}}},
    {"0x75 starting an dictionary key",
     "ua=1",
     {Dictionary{{{"ua", {Integer(1), {}}}}}}},
    {"0x76 starting an dictionary key",
     "va=1",
     {Dictionary{{{"va", {Integer(1), {}}}}}}},
    {"0x77 starting an dictionary key",
     "wa=1",
     {Dictionary{{{"wa", {Integer(1), {}}}}}}},
    {"0x78 starting an dictionary key",
     "xa=1",
     {Dictionary{{{"xa", {Integer(1), {}}}}}}},
    {"0x79 starting an dictionary key",
     "ya=1",
     {Dictionary{{{"ya", {Integer(1), {}}}}}}},
    {"0x7a starting an dictionary key",
     "za=1",
     {Dictionary{{{"za", {Integer(1), {}}}}}}},
    {"0x7b starting an dictionary key", "{a=1", base::nullopt},
    {"0x7c starting an dictionary key", "|a=1", base::nullopt},
    {"0x7d starting an dictionary key", "}a=1", base::nullopt},
    {"0x7e starting an dictionary key", "~a=1", base::nullopt},
    {"0x7f starting an dictionary key", "\177a=1", base::nullopt},
    {"basic parameterised dict",
     "abc=123;a=1;b=2, def=456, ghi=789;q=9;r=\"+w\"",
     {Dictionary{
         {{"abc", {Integer(123), {Param("a", 1), Param("b", 2)}}},
          {"def", {Integer(456), {}}},
          {"ghi", {Integer(789), {Param("q", 9), Param("r", "+w")}}}}}}},
    {"single item parameterised dict",
     "a=b; q=1.0",
     {Dictionary{
         {{"a", {Item("b", Item::kTokenType), {DoubleParam("q", 1.000000)}}}}}},
     "a=b;q=1.0"},
    {"list item parameterised dictionary",
     "a=(1 2); q=1.0",
     {Dictionary{{{"a",
                   {{{Integer(1), {}}, {Integer(2), {}}},
                    {DoubleParam("q", 1.000000)}}}}}},
     "a=(1 2);q=1.0"},
    {"missing parameter value parameterised dict",
     "a=3;c;d=5",
     {Dictionary{
         {{"a", {Integer(3), {BooleanParam("c", true), Param("d", 5)}}}}}}},
    {"terminal missing parameter value parameterised dict",
     "a=3;c=5;d",
     {Dictionary{
         {{"a", {Integer(3), {Param("c", 5), BooleanParam("d", true)}}}}}}},
    {"no whitespace parameterised dict",
     "a=b;c=1,d=e;f=2",
     {Dictionary{{{"a", {Item("b", Item::kTokenType), {Param("c", 1)}}},
                  {"d", {Item("e", Item::kTokenType), {Param("f", 2)}}}}}},
     "a=b;c=1, d=e;f=2"},
    {"whitespace before = parameterised dict", "a=b;q =0.5", base::nullopt},
    {"whitespace after = parameterised dict", "a=b;q= 0.5", base::nullopt},
    {"whitespace before ; parameterised dict", "a=b ;q=0.5", base::nullopt},
    {"whitespace after ; parameterised dict",
     "a=b; q=0.5",
     {Dictionary{
         {{"a", {Item("b", Item::kTokenType), {DoubleParam("q", 0.500000)}}}}}},
     "a=b;q=0.5"},
    {"extra whitespace parameterised dict",
     "a=b;  c=1  ,  d=e; f=2; g=3",
     {Dictionary{
         {{"a", {Item("b", Item::kTokenType), {Param("c", 1)}}},
          {"d",
           {Item("e", Item::kTokenType), {Param("f", 2), Param("g", 3)}}}}}},
     "a=b;c=1, d=e;f=2;g=3"},
    {"two lines parameterised list",
     "a=b;c=1, d=e;f=2",
     {Dictionary{{{"a", {Item("b", Item::kTokenType), {Param("c", 1)}}},
                  {"d", {Item("e", Item::kTokenType), {Param("f", 2)}}}}}},
     "a=b;c=1, d=e;f=2"},
    {"trailing comma parameterised list", "a=b; q=1.0,", base::nullopt},
    {"empty item parameterised list", "a=b; q=1.0,,c=d", base::nullopt},
    {"0x01 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\001a", {Integer(1), {}}}}}}},
    {"0x02 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\002a", {Integer(1), {}}}}}}},
    {"0x03 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\003a", {Integer(1), {}}}}}}},
    {"0x04 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\004a", {Integer(1), {}}}}}}},
    {"0x05 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\005a", {Integer(1), {}}}}}}},
    {"0x06 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\006a", {Integer(1), {}}}}}}},
    {"0x07 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\aa", {Integer(1), {}}}}}}},
    {"0x08 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\ba", {Integer(1), {}}}}}}},
    {"0x09 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\ta", {Integer(1), {}}}}}}},
    {"0x0a in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\na", {Integer(1), {}}}}}}},
    {"0x0b in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\va", {Integer(1), {}}}}}}},
    {"0x0c in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\fa", {Integer(1), {}}}}}}},
    {"0x0d in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\ra", {Integer(1), {}}}}}}},
    {"0x0e in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\016a", {Integer(1), {}}}}}}},
    {"0x0f in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\017a", {Integer(1), {}}}}}}},
    {"0x10 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\020a", {Integer(1), {}}}}}}},
    {"0x11 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\021a", {Integer(1), {}}}}}}},
    {"0x12 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\022a", {Integer(1), {}}}}}}},
    {"0x13 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\023a", {Integer(1), {}}}}}}},
    {"0x14 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\024a", {Integer(1), {}}}}}}},
    {"0x15 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\025a", {Integer(1), {}}}}}}},
    {"0x16 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\026a", {Integer(1), {}}}}}}},
    {"0x17 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\027a", {Integer(1), {}}}}}}},
    {"0x18 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\030a", {Integer(1), {}}}}}}},
    {"0x19 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\031a", {Integer(1), {}}}}}}},
    {"0x1a in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\032a", {Integer(1), {}}}}}}},
    {"0x1b in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\033a", {Integer(1), {}}}}}}},
    {"0x1c in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\034a", {Integer(1), {}}}}}}},
    {"0x1d in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\035a", {Integer(1), {}}}}}}},
    {"0x1e in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\036a", {Integer(1), {}}}}}}},
    {"0x1f in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\037a", {Integer(1), {}}}}}}},
    {"0x20 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a a", {Integer(1), {}}}}}}},
    {"0x21 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a!a", {Integer(1), {}}}}}}},
    {"0x22 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\"a", {Integer(1), {}}}}}}},
    {"0x23 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a#a", {Integer(1), {}}}}}}},
    {"0x24 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a$a", {Integer(1), {}}}}}}},
    {"0x25 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a%a", {Integer(1), {}}}}}}},
    {"0x26 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a&a", {Integer(1), {}}}}}}},
    {"0x27 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a'a", {Integer(1), {}}}}}}},
    {"0x28 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a(a", {Integer(1), {}}}}}}},
    {"0x29 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a)a", {Integer(1), {}}}}}}},
    {"0x2b in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a+a", {Integer(1), {}}}}}}},
    {"0x2c in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a,a", {Integer(1), {}}}}}}},
    {"0x2f in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a/a", {Integer(1), {}}}}}}},
    {"0x3a in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a:a", {Integer(1), {}}}}}}},
    {"0x3b in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a;a", {Integer(1), {}}}}}}},
    {"0x3c in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a<a", {Integer(1), {}}}}}}},
    {"0x3d in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a=a", {Integer(1), {}}}}}}},
    {"0x3e in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a>a", {Integer(1), {}}}}}}},
    {"0x3f in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a?a", {Integer(1), {}}}}}}},
    {"0x40 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a@a", {Integer(1), {}}}}}}},
    {"0x41 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aAa", {Integer(1), {}}}}}}},
    {"0x42 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aBa", {Integer(1), {}}}}}}},
    {"0x43 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aCa", {Integer(1), {}}}}}}},
    {"0x44 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aDa", {Integer(1), {}}}}}}},
    {"0x45 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aEa", {Integer(1), {}}}}}}},
    {"0x46 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aFa", {Integer(1), {}}}}}}},
    {"0x47 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aGa", {Integer(1), {}}}}}}},
    {"0x48 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aHa", {Integer(1), {}}}}}}},
    {"0x49 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aIa", {Integer(1), {}}}}}}},
    {"0x4a in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aJa", {Integer(1), {}}}}}}},
    {"0x4b in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aKa", {Integer(1), {}}}}}}},
    {"0x4c in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aLa", {Integer(1), {}}}}}}},
    {"0x4d in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aMa", {Integer(1), {}}}}}}},
    {"0x4e in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aNa", {Integer(1), {}}}}}}},
    {"0x4f in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aOa", {Integer(1), {}}}}}}},
    {"0x50 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aPa", {Integer(1), {}}}}}}},
    {"0x51 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aQa", {Integer(1), {}}}}}}},
    {"0x52 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aRa", {Integer(1), {}}}}}}},
    {"0x53 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aSa", {Integer(1), {}}}}}}},
    {"0x54 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aTa", {Integer(1), {}}}}}}},
    {"0x55 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aUa", {Integer(1), {}}}}}}},
    {"0x56 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aVa", {Integer(1), {}}}}}}},
    {"0x57 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aWa", {Integer(1), {}}}}}}},
    {"0x58 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aXa", {Integer(1), {}}}}}}},
    {"0x59 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aYa", {Integer(1), {}}}}}}},
    {"0x5a in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"aZa", {Integer(1), {}}}}}}},
    {"0x5b in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a[a", {Integer(1), {}}}}}}},
    {"0x5c in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\\a", {Integer(1), {}}}}}}},
    {"0x5d in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a]a", {Integer(1), {}}}}}}},
    {"0x5e in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a^a", {Integer(1), {}}}}}}},
    {"0x60 in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a`a", {Integer(1), {}}}}}}},
    {"0x7b in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a{a", {Integer(1), {}}}}}}},
    {"0x7c in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a|a", {Integer(1), {}}}}}}},
    {"0x7d in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a}a", {Integer(1), {}}}}}}},
    {"0x7e in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a~a", {Integer(1), {}}}}}}},
    {"0x7f in dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"a\177a", {Integer(1), {}}}}}}},
    {"0x01 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\001a", {Integer(1), {}}}}}}},
    {"0x02 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\002a", {Integer(1), {}}}}}}},
    {"0x03 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\003a", {Integer(1), {}}}}}}},
    {"0x04 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\004a", {Integer(1), {}}}}}}},
    {"0x05 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\005a", {Integer(1), {}}}}}}},
    {"0x06 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\006a", {Integer(1), {}}}}}}},
    {"0x07 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\aa", {Integer(1), {}}}}}}},
    {"0x08 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\ba", {Integer(1), {}}}}}}},
    {"0x09 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\ta", {Integer(1), {}}}}}}},
    {"0x0a starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\na", {Integer(1), {}}}}}}},
    {"0x0b starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\va", {Integer(1), {}}}}}}},
    {"0x0c starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\fa", {Integer(1), {}}}}}}},
    {"0x0d starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\ra", {Integer(1), {}}}}}}},
    {"0x0e starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\016a", {Integer(1), {}}}}}}},
    {"0x0f starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\017a", {Integer(1), {}}}}}}},
    {"0x10 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\020a", {Integer(1), {}}}}}}},
    {"0x11 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\021a", {Integer(1), {}}}}}}},
    {"0x12 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\022a", {Integer(1), {}}}}}}},
    {"0x13 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\023a", {Integer(1), {}}}}}}},
    {"0x14 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\024a", {Integer(1), {}}}}}}},
    {"0x15 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\025a", {Integer(1), {}}}}}}},
    {"0x16 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\026a", {Integer(1), {}}}}}}},
    {"0x17 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\027a", {Integer(1), {}}}}}}},
    {"0x18 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\030a", {Integer(1), {}}}}}}},
    {"0x19 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\031a", {Integer(1), {}}}}}}},
    {"0x1a starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\032a", {Integer(1), {}}}}}}},
    {"0x1b starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\033a", {Integer(1), {}}}}}}},
    {"0x1c starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\034a", {Integer(1), {}}}}}}},
    {"0x1d starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\035a", {Integer(1), {}}}}}}},
    {"0x1e starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\036a", {Integer(1), {}}}}}}},
    {"0x1f starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\037a", {Integer(1), {}}}}}}},
    {"0x20 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{" a", {Integer(1), {}}}}}}},
    {"0x21 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"!a", {Integer(1), {}}}}}}},
    {"0x22 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\"a", {Integer(1), {}}}}}}},
    {"0x23 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"#a", {Integer(1), {}}}}}}},
    {"0x24 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"$a", {Integer(1), {}}}}}}},
    {"0x25 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"%a", {Integer(1), {}}}}}}},
    {"0x26 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"&a", {Integer(1), {}}}}}}},
    {"0x27 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"'a", {Integer(1), {}}}}}}},
    {"0x28 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"(a", {Integer(1), {}}}}}}},
    {"0x29 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{")a", {Integer(1), {}}}}}}},
    {"0x2b starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"+a", {Integer(1), {}}}}}}},
    {"0x2c starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{",a", {Integer(1), {}}}}}}},
    {"0x2d starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"-a", {Integer(1), {}}}}}}},
    {"0x2e starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{".a", {Integer(1), {}}}}}}},
    {"0x2f starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"/a", {Integer(1), {}}}}}}},
    {"0x30 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"0a", {Integer(1), {}}}}}}},
    {"0x31 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"1a", {Integer(1), {}}}}}}},
    {"0x32 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"2a", {Integer(1), {}}}}}}},
    {"0x33 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"3a", {Integer(1), {}}}}}}},
    {"0x34 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"4a", {Integer(1), {}}}}}}},
    {"0x35 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"5a", {Integer(1), {}}}}}}},
    {"0x36 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"6a", {Integer(1), {}}}}}}},
    {"0x37 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"7a", {Integer(1), {}}}}}}},
    {"0x38 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"8a", {Integer(1), {}}}}}}},
    {"0x39 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"9a", {Integer(1), {}}}}}}},
    {"0x3a starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{":a", {Integer(1), {}}}}}}},
    {"0x3b starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{";a", {Integer(1), {}}}}}}},
    {"0x3c starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"<a", {Integer(1), {}}}}}}},
    {"0x3d starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"=a", {Integer(1), {}}}}}}},
    {"0x3e starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{">a", {Integer(1), {}}}}}}},
    {"0x3f starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"?a", {Integer(1), {}}}}}}},
    {"0x40 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"@a", {Integer(1), {}}}}}}},
    {"0x41 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Aa", {Integer(1), {}}}}}}},
    {"0x42 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Ba", {Integer(1), {}}}}}}},
    {"0x43 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Ca", {Integer(1), {}}}}}}},
    {"0x44 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Da", {Integer(1), {}}}}}}},
    {"0x45 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Ea", {Integer(1), {}}}}}}},
    {"0x46 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Fa", {Integer(1), {}}}}}}},
    {"0x47 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Ga", {Integer(1), {}}}}}}},
    {"0x48 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Ha", {Integer(1), {}}}}}}},
    {"0x49 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Ia", {Integer(1), {}}}}}}},
    {"0x4a starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Ja", {Integer(1), {}}}}}}},
    {"0x4b starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Ka", {Integer(1), {}}}}}}},
    {"0x4c starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"La", {Integer(1), {}}}}}}},
    {"0x4d starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Ma", {Integer(1), {}}}}}}},
    {"0x4e starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Na", {Integer(1), {}}}}}}},
    {"0x4f starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Oa", {Integer(1), {}}}}}}},
    {"0x50 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Pa", {Integer(1), {}}}}}}},
    {"0x51 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Qa", {Integer(1), {}}}}}}},
    {"0x52 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Ra", {Integer(1), {}}}}}}},
    {"0x53 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Sa", {Integer(1), {}}}}}}},
    {"0x54 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Ta", {Integer(1), {}}}}}}},
    {"0x55 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Ua", {Integer(1), {}}}}}}},
    {"0x56 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Va", {Integer(1), {}}}}}}},
    {"0x57 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Wa", {Integer(1), {}}}}}}},
    {"0x58 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Xa", {Integer(1), {}}}}}}},
    {"0x59 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Ya", {Integer(1), {}}}}}}},
    {"0x5a starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"Za", {Integer(1), {}}}}}}},
    {"0x5b starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"[a", {Integer(1), {}}}}}}},
    {"0x5c starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\\a", {Integer(1), {}}}}}}},
    {"0x5d starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"]a", {Integer(1), {}}}}}}},
    {"0x5e starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"^a", {Integer(1), {}}}}}}},
    {"0x5f starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"_a", {Integer(1), {}}}}}}},
    {"0x60 starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"`a", {Integer(1), {}}}}}}},
    {"0x7b starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"{a", {Integer(1), {}}}}}}},
    {"0x7c starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"|a", {Integer(1), {}}}}}}},
    {"0x7d starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"}a", {Integer(1), {}}}}}}},
    {"0x7e starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"~a", {Integer(1), {}}}}}}},
    {"0x7f starting an dictionary key - serialise only",
     nullptr,
     {Dictionary{{{"\177a", {Integer(1), {}}}}}}},
};
}  // namespace

TEST(StructuredHeaderGeneratedTest, ParseList) {
  for (const auto& c : list_test_cases) {
    if (c.raw) {
      SCOPED_TRACE(c.name);
      base::Optional<List> result = ParseList(c.raw);
      EXPECT_EQ(result, c.expected);
    }
  }
}

TEST(StructuredHeaderGeneratedTest, ParseDictionary) {
  for (const auto& c : dictionary_test_cases) {
    if (c.raw) {
      SCOPED_TRACE(c.name);
      base::Optional<Dictionary> result = ParseDictionary(c.raw);
      EXPECT_EQ(result, c.expected);
    }
  }
}

TEST(StructuredHeaderGeneratedTest, SerializeList) {
  for (const auto& c : list_test_cases) {
    SCOPED_TRACE(c.name);
    if (c.expected) {
      base::Optional<std::string> result = SerializeList(*c.expected);
      if (c.raw || c.canonical) {
        EXPECT_TRUE(result.has_value());
        EXPECT_EQ(result.value(),
                  std::string(c.canonical ? c.canonical : c.raw));
      } else {
        EXPECT_FALSE(result.has_value());
      }
    }
  }
}

TEST(StructuredHeaderGeneratedTest, SerializeDictionary) {
  for (const auto& c : dictionary_test_cases) {
    SCOPED_TRACE(c.name);
    if (c.expected) {
      base::Optional<std::string> result = SerializeDictionary(*c.expected);
      if (c.raw || c.canonical) {
        EXPECT_TRUE(result.has_value());
        EXPECT_EQ(result.value(),
                  std::string(c.canonical ? c.canonical : c.raw));
      } else {
        EXPECT_FALSE(result.has_value());
      }
    }
  }
}

}  // namespace structured_headers
}  // namespace net
